"use strict";JQX("jqx-input",function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"template",value:function(){return"<div id=\"inputContainer\"><input class=\"jqx-input\" id='input' readonly='[[readonly]]' placeholder='[[placeholder]]' type='[[type]]' name='[[name]]' value='{{value::keyup}}' disabled='[[disabled]]' role='input'/><div id=\"dropDownButton\" tabindex=-1 class=\"jqx-drop-down-button\"><div id=\"arrow\" class=\"arrow\"></div></div></div>"}},{key:"focus",value:function(){this.$.input.focus()}},{key:"select",value:function(){var e=this;e.readonly?e.$.input.focus():e.$.input.select()}},{key:"_documentUpHandler",value:function(e){var t=this,o=e.originalEvent.target;if(o!==t&&o!==t.$.dropDownButton&&o!==t.$.input&&o!==t.$.arrow){if(t.$.scrollView.contains(o))return void(t._isPointerDown&&(t._isPointerDown=!1,t.$.input.focus()));t._isPointerDown=!1,t.close()}}},{key:"_focusHandler",value:function(){this.setAttribute("focus","")}},{key:"_blurHandler",value:function(){var e=this;e.opened||e.removeAttribute("focus")}},{key:"_refreshMenu",value:function(){var e=this;e.$.menu.classList.remove("scroll"),e.$.scrollView.computedVerticalScrollBarVisibility&&e.$.menu.classList.add("scroll")}},{key:"_performSelect",value:function(){var e=this,t=e.$.menu.querySelector(".active"),o=t.getAttribute("data-label"),r=t.getAttribute("value"),n=e.value,a=e.$.input.dataValue;e.value=o,e.$.input.dataValue=r,e.$.fireEvent("change",{value:r,label:o,oldValue:a,oldLabel:n}),e.close()}},{key:"_offsetTop",value:function(e){var t=this;return e?e.offsetTop+t._offsetTop(e.offsetParent)-(e.offsetParent?e.offsetParent.scrollTop:0):0}},{key:"_offsetLeft",value:function(e){var t=this;return e?e.offsetLeft+t._offsetLeft(e.offsetParent)-(e.offsetParent?e.offsetParent.scrollLeft:0):0}},{key:"_offset",value:function(e){return{left:this._offsetLeft(e),top:this._offsetTop(e)}}},{key:"_open",value:function(){var e=this,t=e._offset(e);this.opened||(e.timer&&clearTimeout(e.timer),document.body.appendChild(e.$.scrollView),e.$.scrollView.style.setProperty("--jqx-input-drop-down-menu-width",""),e.$.scrollView.style.left=-3+t.left+"px",e.$.scrollView.style.top=t.top+e.offsetHeight+1+"px",e.$.scrollView.classList.remove("open"),e.$.scrollView.onpointerdown=function(){e._isPointerDown=!0},requestAnimationFrame(function(){if(e.$.scrollView.refresh(),e._refreshMenu(),e.$.scrollView.setAttribute("open",""),e.setAttribute("open",""),e.$.dropDownButton.setAttribute("open",""),e.$.input.setAttribute("open",""),"auto"!==e.dropDownWidth&&e.dropDownWidth)e.$.scrollView.style.setProperty("--jqx-input-drop-down-menu-width",e.dropDownWidth+"px");else if("auto"===e.dropDownWidth)e.$.scrollView.style.setProperty("--jqx-input-drop-down-menu-width","");else{e.$.menu.style.width="auto";for(var t=e.$.menu.offsetWidth,o=e.$.menu.querySelectorAll("li"),r=0;r<o.length;r++)e._maxDropDownWidth=Math.max(o[r].firstElementChild.offsetWidth,e._maxDropDownWidth);e.$.scrollView.computedVerticalScrollBarVisibility&&(t+=30),e.$.scrollView.style.setProperty("--jqx-input-drop-down-menu-width",Math.max(t,e.offsetWidth-8)+"px")}}),e.$.scrollView.refresh(),e._refreshMenu(),this.opened=!0)}},{key:"close",value:function(){var e=this;return!!e.opened&&(e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){e.$.scrollView.parentNode&&!e.opened&&document.body.removeChild(e.$.scrollView)},1e3),e.$.scrollView.removeAttribute("open"),e.$.dropDownButton.removeAttribute("open"),e.$.input.removeAttribute("open"),e.removeAttribute("open"),e.opened=!1,e.$.input.focus(),!0)}},{key:"_lookup",value:function(e){var t=this,o=[];return t.query=t.$.input.value,t.$.input.readonly&&(t._incrementalSearchQuery||(t._incrementalSearchQuery=""),t._incrementalSearchQuery+=e.key,t._incrementalSearchTimer&&clearTimeout(t._incrementalSearchTimer),t.query=t._incrementalSearchQuery,t._incrementalSearchTimer=setTimeout(function(){t._incrementalSearchQuery=""},700)),!t.query||t.query.length<t.minLength?void t.close():(o="function"==typeof t.dataSource?t.dataSource(t.query):t.dataSource,t._process(o))}},{key:"_downHandler",value:function(e){var t=this;t.readonly&&t._dropDownButtonDownHandler(e)}},{key:"_dropDownButtonDownHandler",value:function(e){return this._toggle(),e.preventDefault(),e.stopPropagation(),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation(),!1}},{key:"_toggle",value:function(){var e=this;e.opened?e.close():e.open()}},{key:"open",value:function(){var e=this,t=void 0;e.dropDownDataSource?(e.query="",t="function"==typeof e.dataSource?e.dataSource(e.query):e.dataSource):t="function"==typeof e.dropDownDataSource?e.dropDownDataSource(e.query):e.dropDownDataSource,e._process(t);var o=e.$.menu.querySelector(".active");if(o)for(var r=e.$.input.dataValue,n=0;n<e.$.menu.children.length;n++){var a=e.$.menu.children[n],i=a.getAttribute("data-label"),s=a.getAttribute("value");if(void 0!==r&&s===r||void 0===r&&i===e.$.input.value){o.classList.remove("active"),a.classList.add("active"),e.$.input.dataValue=s;break}}e.ensureVisible(),e.$.input.focus(),setTimeout(function(){e.$.input.focus()},25)}},{key:"_process",value:function(e){var t=this;"string"==typeof e&&(e=t.$.deserialize(e,"array")),e=e.filter(function(e){return t.matcher?t.matcher(e):t._matcher(e)}),e=t._sorter(e),t.sorted&&(e.sort(function(e,t){return void 0!==e.label?e.label.localeCompare(t.label):e.localeCompare(t)}),"desc"===t.sortDirection&&e.reverse()),!e.length&&t.opened&&t.close(),0!==e.length&&(t.query.length>0?t._render(e.slice(0,t.items)):t._render(e),t._open(),t.$.scrollView.refresh(),t._refreshMenu(),t.ensureVisible())}},{key:"_matcher",value:function(e){var t=this,o=t.query;switch(e=e.label||e,t.queryMode){case"startsWith":return e.startsWith(o);case"startsWithIgnoreCase":return e.toLowerCase().startsWith(o.toLowerCase());case"doesNotContain":return e.indexOf(o)<0;case"doesNotContainIgnoreCase":return e.toLowerCase().indexOf(o.toLowerCase())<0;case"contains":return e.indexOf(o)>-1;default:case"containsIgnoreCase":return~e.toLowerCase().indexOf(o.toLowerCase());case"equals":return 0===e.localeCompare(o);case"equalsIgnoreCase":return 0===e.toLowerCase().localeCompare(o.toLowerCase());case"endsWith":return e.endsWith(o);case"endsWithIgnoreCase":return e.toLowerCase().endsWith(o.toLowerCase())}}},{key:"_sorter",value:function(e){for(var t=this,o=[],r=[],n=[],a=void 0;a=e.shift();){var i=a.label||a;i.toLowerCase().indexOf(t.query.toLowerCase())?~i.indexOf(t.query)?r.push(a):n.push(a):o.push(a)}return o.concat(r,n)}},{key:"_highlighter",value:function(e){var t=this,o=t.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+o+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})}},{key:"_render",value:function(e){function t(){var e=o.$.menu.getElementsByClassName("active");e[0]&&e[0].classList.remove("active"),this.classList.add("active")}var o=this,r=e.map(function(e){var t=e,r=e;"object"===(void 0===e?"undefined":babelHelpers.typeof(e))&&(t=e.label,r=e.value||t);var n=document.createElement("li"),a=document.createElement("a");return a.href="#",n.setAttribute("data-label",t),n.setAttribute("value",r),a.innerHTML=o.highlighter?o.highlighter(t):o._highlighter(t),e.icon&&(a.classList.add("icon"),a.classList.add(e.icon)),n.appendChild(a),n});r.length>0&&r[0].classList.add("active"),o.$.menu.innerHTML="";for(var n=0;n<r.length;n++){var a=r[n];o.$.menu.appendChild(a),a.onmouseenter=t,a.onmouseleave=function(){this.classList.remove("active")},a.onclick=t}}},{key:"ensureVisible",value:function(){var e=this,t=e.$.menu.querySelector(".active");t&&(t.offsetTop+t.offsetHeight>=e.$.scrollView.scrollTop+e.$.scrollView.offsetHeight&&(e.$.scrollView.scrollTop=t.offsetTop+t.offsetHeight),(t.offsetTop<=e.$.scrollView.scrollTop||t.offsetTop>=e.$.scrollView.scrollTop+e.$.scrollView.offsetHeight)&&(e.$.scrollView.scrollTop=t.offsetTop),0===[].concat(babelHelpers.toConsumableArray(e.$.menu.children)).indexOf(t)?e.$.scrollView.scrollTop=0:[].concat(babelHelpers.toConsumableArray(e.$.menu.children)).indexOf(t)===e.$.menu.children.length-1&&(e.$.scrollView.scrollTop=e.$.scrollView.scrollHeight))}},{key:"_next",value:function(){var e=this,t=e.$.menu.querySelector(".active");if(!t)return void e.$.menu.firstElementChild.classList.add("active");t.classList.remove("active");var o=t.nextElementSibling;o||(o=e.$.menu.firstElementChild),o.classList.add("active"),e.ensureVisible()}},{key:"_prev",value:function(){var e=this,t=e.$.menu.querySelector(".active");if(!t)return void e.$.menu.firstElementChild.classList.add("active");t.classList.remove("active");var o=t.previousElementSibling;o||(o=e.$.menu.lastElementChild),o.classList.add("active"),e.ensureVisible()}},{key:"_move",value:function(e){var t=this;if(t.opened){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),t._prev();break;case 40:e.preventDefault(),t._next()}e.stopPropagation()}}},{key:"_keyDownHandler",value:function(e){var t=this;t._suppressKeyPressRepeat=![40,38,9,13,27,16,17,18].includes(e.keyCode),e.shiftKey||e.altKey||e.ctrlKey||t._move(e)}},{key:"_keyPressHandler",value:function(e){var t=this;t._suppressKeyPressRepeat||e.shiftKey||e.altKey||e.ctrlKey||t._move(e)}},{key:"_keyUpHandler",value:function(e){var t=this;if(!(e.shiftKey||e.altKey||e.ctrlKey))switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:40===e.keyCode&&e.altKey&&t.open(),38===e.keyCode&&e.altKey&&t.close();break;case 9:case 13:if(!t.opened)return;t._performSelect(),e.stopPropagation(),e.preventDefault();break;case 27:if(!t.opened)return;t.close(),e.stopPropagation(),e.preventDefault();break;default:t._lookup(e),!t.opened||e.ctrlKey||e.shiftKey||(e.stopPropagation(),e.preventDefault()),t.$.input.dataValue=t.$.input.value}}},{key:"propertyChangedHandler",value:function(e,o,r){babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"propertyChangedHandler",this).call(this,e,o,r);var n=this;"dropDownHeight"===e&&n.$.scrollView.style.setProperty("--jqx-input-drop-down-menu-height",n.dropDownHeight+"px"),"opened"===e&&(r?n.open():n.close()),"theme"===e&&(n.$.scrollView.theme=r)}},{key:"ready",value:function(){var e=this;babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this);var o=document.createElement("ul"),r=document.createElement("jqx-scroll-viewer");r.theme=e.theme,r.horizontalScrollBarVisibility="hidden",r.appendChild(o),r.style.setProperty("--jqx-input-drop-down-menu-height",e.dropDownHeight+"px"),r.classList.add("jqx-input-drop-down-menu"),r.id=e.id+"_"+e.tagName.toLowerCase()+"_menu_"+Math.floor(65536*(1+Math.random())).toString(16).substring(1),e.setAttribute("aria-controls",r.id),r.ownerElement=e,e.$.scrollView=r,e.$.menu=o,e.opened&&e.open(),e.opened=!1,e.$.menu.onclick=function(t){t.stopPropagation(),t.preventDefault(),e._performSelect(),e.$.input.focus()}}}],[{key:"properties",get:function(){return{dataSource:{type:"any",value:[]},dropDownDataSource:{type:"any",value:[]},dropDownHeight:{type:"any",value:200},dropDownWidth:{type:"any",value:null},dropDownButtonPosition:{allowedValues:["none","left","right"],value:"none",type:"string"},items:{type:"number",value:8},minLength:{type:"number",value:1},name:{value:"",type:"string"},opened:{value:!1,type:"boolean"},query:{type:"string",value:""},queryMode:{allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase"],type:"string",value:"containsIgnoreCase"},placeholder:{value:"",type:"string"},readonly:{type:"boolean",value:!1},sorted:{value:!1,type:"boolean"},sortDirection:{value:"asc",type:"string"},type:{type:"string"},value:{type:"string",value:""}}}},{key:"styleUrls",get:function(){return["jqx.textbox.css"]}},{key:"listeners",get:function(){return{"input.focus":"_focusHandler","input.blur":"_blurHandler","input.keydown":"_keyDownHandler","input.keyup":"_keyUpHandler","input.keypress":"_keyPressHandler","dropDownButton.down":"_dropDownButtonDownHandler","inputContainer.down":"_downHandler","document.up":"_documentUpHandler"}}}]),t}(JQX.BaseElement));
//# sourceMappingURL=jqxinput.js.map
