"use strict";JQX.Utilities.Assign("Grid.Sort",function(){function r(){babelHelpers.classCallCheck(this,r)}return babelHelpers.createClass(r,[{key:"clearSort",value:function(){var r=this;if(!r._isSorting){r._isSorting=!0,r.dataSource.clearSort();for(var t=0;t<r._sortedColumns.length;t++){var o=r._sortedColumns[t],e=r.columnByDataField[o.dataField];e.setProperty("sortOrder",null),e.setProperty("sortIndex",null)}r._sortedColumns=[];for(var s=0;s<r.dataSource.length;s++){var n=r.rows[s],a=r.dataSource[s];n.data=a,n.boundIndex=a.boundIndex}r._recycle(),r._isSorting=!1}}},{key:"getSortedColumns",value:function(){var r=this,t=[];if(r._sortedColumns)for(var o=0;o<r._sortedColumns.length;o++){var e=r._sortedColumns[o];t[e.dataField]={sortOrder:e.sortOrder,sortIndex:e.sortIndex},t.length++}return t}},{key:"addSort",value:function(r,t){this.sortBy(r,t)}},{key:"removeSort",value:function(r){this.sortBy(r,null)}},{key:"sortBy",value:function(r,t){var o=this,e=o.columnByDataField[r],s=[],n=[],a=[],i=void 0===t;if(!o._isSorting&&e){o._isSorting=!0,void 0===t&&(t="asc");var d=function(r){r.setProperty("sortOrder",null)},l=function(){if(o._sortedColumns.length>0)for(var r=0;r<o._sortedColumns.length;r++){var t=o._sortedColumns[r],e=o.columnByDataField[t.dataField];d(e)}o._sortedColumns=[]};if(null===e)return l(),void(o._isSorting=!1);if(!o.sorting.enabled||!o.dataSource||!e.allowSort||o._sortAnimation)return void(o._isSorting=!1);d(e),o._sortedColumns||(o._sortedColumns=[]);for(var u="string",f=0;f<o.dataSource.dataFields.length;f++){var m=o.dataSource.dataFields[f];if(m.name===r){u=m.dataType;break}}for(var c=!0,v=0;v<o._sortedColumns.length;v++){var g=o._sortedColumns[v];if(g.dataField===r)if(c=!1,g.sortIndex=e.sortIndex,i){if("asc"===g.sortOrder)g.sortOrder="desc",t="desc";else if("desc"===g.sortOrder){o.sorting.sortToggleThreeStates?(o._sortedColumns.splice(v,1),d(e),t=null):(g.sortOrder="asc",t="asc");break}}else g.sortOrder=t,null===t&&(o._sortedColumns.splice(v,1),d(e))}c&&("one"===o.sorting.mode&&l(),null!==t&&o._sortedColumns.push({dataField:r,sortOrder:t,sortIndex:e.sortIndex,dataType:u})),e.setProperty("sortOrder",t),o._sortedColumns.sort(function(r,t){return"string"==typeof r.sortIndex&&"string"==typeof t.sortIndex?0:"number"==typeof r.sortIndex&&"string"==typeof t.sortIndex?-1:"string"==typeof r.sortIndex&&"number"==typeof t.sortIndex?1:"number"==typeof r.sortIndex&&"number"==typeof t.sortIndex?r.sortIndex-t.sortIndex:void 0});for(var _=0;_<o._sortedColumns.length;_++){var y=o._sortedColumns[_];s.push(y.dataField),n.push(y.sortOrder),a.push(y.dataType)}var p=function(){if(o.dataSource&&o.dataSource.virtualDataSource)o._virtualDataRequest("sort");else{if(o.dataSource.sortBy(s,a,n),o.dataSource.boundHierarchy)o._refreshRowHierarchy();else for(var r=0;r<o.dataSource.length;r++){var t=o.rows[r],e=o.dataSource[r];t.data=e,t.boundIndex=e.boundIndex}o._recycle()}o.$.fireEvent("sort",{data:o.getSortedColumns()})};if(o.appearance.allowSortAnimation){var h=[],S=[];o.rows.canNotify=!1,o._sortAnimation=!0;var x=function(){for(var r=0;r<o._rowElements.length;r++){var t=o._rowElements[r];t.classList.remove("jqx-grid-sort-animation"),o.removeTransformMoveStyle(t),t.offsetHeight>0&&h.push(t.offsetTop)}};x(),o._sortTimer=setTimeout(function(){x(),o._sortAnimation=!1,o.rows.canNotify=!0},o.appearance.sortAnimationDuration),o._sortTimer2=setTimeout(function(){p()},o.appearance.sortAnimationDuration/2);for(var C=0;C<h.length;C++)!function(r){var t=o._rowElements[r];t.classList.remove("jqx-grid-sort-animation"),o.removeTransformMoveStyle(t);for(var e=Math.floor(Math.random()*h.length-1+1);S[e];)e=Math.floor(Math.random()*h.length-1+1);S[e]=!0,o.addTransformMoveStyle(t,"0ms",0,-t.offsetTop+h[e],0,.5),t.classList.add("jqx-grid-sort-animation"),setTimeout(function(){o.addTransformMoveStyle(t,o.appearance.sortAnimationDuration+"ms",0,0,0,1)}),setTimeout(function(){t.classList.remove("jqx-grid-sort-animation")},o.appearance.sortAnimationDuration)}(C)}else p();o._isSorting=!1}}}]),r}());
//# sourceMappingURL=jqxgrid.sort.js.map
