"use strict";JQX("jqx-tree-item",function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"ready",value:function(){Object.defineProperty(this,"hasStyleObserver",{get:function(){return!1}}),babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this)}},{key:"propertyChangedHandler",value:function(e,t,r){var n=this,a=n.menu;if("level"===e)return void(n.level=t);if("disabled"!==e&&"separator"!==e&&a){var l=a.context;switch(a.context=a,e){case"label":var o=a.sorted&&a.autoSort;n.firstElementChild.firstElementChild.firstElementChild.innerHTML=r,o&&(a._unsortItems(a.$.mainContainer),a._applyGrouping(a.$.mainContainer)),a._state.filter&&a._applyFilter(a._state.filter);break;case"selected":n.selected=t,r?a.select(n):a.unselect(n);break;case"shortcut":var i=n.firstElementChild.children[1];i||(i=document.createElement("div"),i.className="jqx-tree-item-shortcut",n.firstElementChild.appendChild(i)),i.innerHTML=r;break;case"value":a.sort&&a.sorted&&a.autoSort&&a._refreshSorting()}a.context=l}}}],[{key:"properties",get:function(){return{selected:{value:!1,type:"boolean"}}}}]),t}(JQX.MenuItem)),JQX("jqx-tree-items-group",function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"ready",value:function(){Object.defineProperty(this,"hasStyleObserver",{get:function(){return!1}}),babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this)}},{key:"propertyChangedHandler",value:function(e,t,r){var n=this,a=n.menu;if("level"===e)return void(n.level=t);if("disabled"!==e&&"separator"!==e&&a){var l=a.context;switch(a.context=a,e){case"expanded":n.expanded=t,r?a.expandItem(n):a.collapseItem(n);break;case"label":var o=a.sorted&&a.autoSort;n.firstElementChild.firstElementChild.firstElementChild.innerHTML=r,o&&(a._unsortItems(a.$.mainContainer),a._applyGrouping(a.$.mainContainer)),a._state.filter&&a._applyFilter(a._state.filter);break;case"selected":n.selected=t,r?a.select(n):a.unselect(n);break;case"value":a.sort&&a.sorted&&a.autoSort&&a._refreshSorting()}a.context=l}}}],[{key:"properties",get:function(){return{selected:{value:!1,type:"boolean"}}}}]),t}(JQX.MenuItemsGroup)),JQX("jqx-tree",function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"template",value:function(){return'<div id="container">\n                    <div class="jqx-tree-filter-input-container">\n                        <input id="filterInput" class="jqx-filter-input" disabled="[[disabled]]" placeholder="[[filterInputPlaceholder]]" type="text" />\n                    </div>\n                    <jqx-repeat-button id="scrollButtonNear" class="jqx-tree-scroll-button jqx-spin-button jqx-scroll-button-near jqx-hidden" animation="[[animation]]" unfocusable>\n                        <div id="arrowNear" class="jqx-arrow jqx-arrow-up"></div>\n                    </jqx-repeat-button>\n                    <jqx-scroll-viewer id="scrollViewer" animation="[[animation]]" horizontal-scroll-bar-visibility="hidden" right-to-left="[[right-to-left]]">\n                        <div id="mainContainer" class="jqx-tree-main-container">\n                            <content></content>\n                        </div>\n                        <input type="text" id="editInput" class="jqx-tree-edit-input jqx-hidden" />\n                    </jqx-scroll-viewer>\n                    <jqx-repeat-button id="scrollButtonFar" class="jqx-tree-scroll-button jqx-spin-button jqx-scroll-button-far jqx-hidden" animation="[[animation]]" unfocusable>\n                        <div id="arrowFar" class="jqx-arrow jqx-arrow-down"></div>\n                    </jqx-repeat-button>\n                    <div id="loadingIndicatorContainer" class="jqx-loader-container jqx-hidden">\n                        <span id="loadingIndicator" class="jqx-loader"></span>\n                        <span id="loadingIndicatorPlaceHolder" class="jqx-loader-label jqx-hidden">[[loadingIndicatorPlaceholder]]</span>\n                    </div>\n                </div>'}},{key:"addAfter",value:function(e,t){var r=this;void 0!==(t=r.getItem(t))&&r.addTo(e,t.parentItem,t,!0)}},{key:"addBefore",value:function(e,t){var r=this;void 0!==(t=r.getItem(t))&&r.addTo(e,t.parentItem,t)}},{key:"addTo",value:function(e,t){var r=this;if(e instanceof JQX.TreeItem||e instanceof JQX.TreeItemsGroup){var n=void 0,a=void 0;if(void 0===t)t=r.$.mainContainer,n=1,a=t;else{if((t=r.getItem(t))instanceof JQX.TreeItemsGroup==!1)return;n=t.level+1,a=t.itemContainer}r._createItemHTMLStructure(e,n,t,a.childElementCount,0);var l=r.sorted&&r.autoSort,o=r._state.filter,i=r.selectedIndexes.slice(0);l&&r._unsortItems(r.$.mainContainer),e instanceof JQX.TreeItemsGroup&&r._processHTML(e,n+1,!1);var s=arguments[2];s&&arguments[3]&&(s=s.nextElementSibling),s?(a.insertBefore(e,s),r._menuItems={},r._refreshItemPaths(r.$.mainContainer,!0,void 0,r.sorted&&!r.autoSort)):a.appendChild(e),l&&r._applyGrouping(r.$.mainContainer),o&&r._applyFilter(o),r._checkOverflow(),r._expandItemsByDefault(),r.selectedIndexes=[],r._applySelection(!0,i)}}},{key:"clearSelection",value:function(){var e=this,t=e.selectedIndexes.slice(0);e.selectedIndexes=[],e._applySelection(!1,t)}},{key:"collapseAll",value:function(e){var t=this,r=t.animation,n=!1===e&&t.hasAnimation;n&&(t.animation="none"),t._collapseAll(!0),n&&(t.animation=r)}},{key:"ensureVisible",value:function(e){var r=this;if(void 0!==(e=r.getItem(e))&&!e.hidden){var n=!1;e.level>1&&!r._isBranchExpanded(e)&&(babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"expandItem",this).call(this,e.parentItem,void 0,!1),(n=r.hasAnimation)&&(r._ensureVisibleOnTransitionend=e)),n||r._ensureVisible(e)}}},{key:"expandAll",value:function(e){var t=this,r=t.animation,n=!1===e&&t.hasAnimation,a=1,l=(t.enableShadowDOM?t.shadowRoot:t).querySelectorAll('jqx-tree-items-group[level="1"]');for(n&&(t.animation="none");l.length>0;){for(var o=0;o<l.length;o++){var i=l[o];i.expanded||t._menuItemsGroupSelectionHandler(i,{target:i,type:"expand"})}a++,l=(t.enableShadowDOM?t.shadowRoot:t).querySelectorAll('jqx-tree-items-group[level="'+a+'"]')}n&&(t.animation=r)}},{key:"expandItem",value:function(e,t){var r=this;if(void 0!==(e=r.getItem(e))&&e instanceof JQX.TreeItemsGroup!=!1&&!r._isContainerOpened(e.container.level,e.container)){var n=!1===t&&r.hasAnimation,a=r.animation;n&&(r.animation="none"),r._discardKeyboardHover(),r._menuItemsGroupSelectionHandler(e,{target:e,type:"expand"},arguments[2]),n&&(r.animation=a)}}},{key:"filter",value:function(e){var t=this;t.filterable&&(t._applyFilter(e),t.$.filterInput.value=e)}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this._state))}},{key:"insert",value:function(e,t){function r(e){var t=e[n.itemsMember]||[],a="jqx-tree-items-group"===e.tagName||t.length>0?"jqx-tree-items-group":"jqx-tree-item",l=document.createElement(a);if(e.disabled&&(l.disabled=!0),e[n.displayMember]&&(l.label=e[n.displayMember]),e.separator&&(l.separator=!0),e[n.valueMember]&&(l.value=e[n.valueMember]),"jqx-tree-items-group"===a){e.expanded&&(l.expanded=!0);for(var o=0;o<t.length;o++)l.appendChild(r(t[o]))}else e.shortcut&&(l.shortcut=e.shortcut);return l}var n=this,a=void 0;if(e instanceof JQX.TreeItem||e instanceof JQX.TreeItemsGroup){if(n.contains(e))return;a=e}else{if("object"!==(void 0===e?"undefined":babelHelpers.typeof(e))||e.constructor!==Object)return;a=r(e)}if(void 0===t)return void n.addTo(a);if("number"==typeof t)t=t.toString();else if(t instanceof JQX.TreeItem||t instanceof JQX.TreeItemsGroup){if(!n.contains(t))return;t=t.path}else if("string"!=typeof t)return;var l=t.split("."),o=void 0,i=void 0;1===l.length?(i=n._menuItems[l[0]],i?n.addBefore(a,i):n.addTo(a)):(i=n._menuItems[t],o=n._menuItems[l.slice(0,l.length-1).join(".")],i?n.addBefore(a,i):o&&o instanceof JQX.TreeItemsGroup&&n.addTo(a,o))}},{key:"loadState",value:function(e){var t=this,r=t.selectedIndexes.slice(0),n=[];if(!e){if(!t.id)return void t.warn(t.localize("noId"));e=window.localStorage.getItem("jqxTree"+t.id)}"string"==typeof e&&(e=JSON.parse(e)),e.filter&&!t.filterable&&(e.filter="");var a=e.filter!==t._state.filter;e.sorted!==t.sorted?(t.sorted=e.sorted,t._updateState("sorted",t.sorted),e.sorted?t._applyGrouping(t.$.mainContainer):t._unsortItems(t.$.mainContainer),(e.filter||a)&&(t._applyFilter(e.filter),t.$.filterInput.value=e.filter)):a&&(t._applyFilter(e.filter),t.$.filterInput.value=e.filter),t._menuItemsGroupsToExpand=[];for(var l=0;l<e.expanded.length;l++){var o=t.getItem(e.expanded[l]);o&&t._menuItemsGroupsToExpand.push(o)}t._expandItemsByDefault(!0);for(var i=0;i<e.selected.length;i++){var s=t.getItem(e.selected[i]);s&&n.push(s.path)}t.selectedIndexes=n,t._applySelection(!1,r)}},{key:"moveDown",value:function(e){var t=this;e=t.getItem(e);var r=e.nextElementSibling;void 0!==e&&r&&!t.sorted&&(t._moveTreeItem(e,r,2,[t]),t.filterable&&t._state.filter&&t._applyFilter(t._state.filter))}},{key:"moveUp",value:function(e){var t=this;e=t.getItem(e);var r=e.previousElementSibling;void 0!==e&&r&&!t.sorted&&(t._moveTreeItem(e,r,0,[t]),t.filterable&&t._state.filter&&t._applyFilter(t._state.filter))}},{key:"refresh",value:function(){this._checkOverflow()}},{key:"removeItem",value:function(e){var t=this;if(void 0!==(e=t.getItem(e))){if(e instanceof JQX.TreeItemsGroup){var r=e.container;t._isContainerOpened(r.level,r)&&t._closeSubContainersTreeMode(r.level,r)}var n=t.sorted&&t.autoSort;n&&t._unsortItems(t.$.mainContainer),e.parentElement.removeChild(e),t._menuItems={},t._refreshItemPaths(t.$.mainContainer,!0,void 0,t.sorted&&!t.autoSort),n&&t._applyGrouping(t.$.mainContainer);var a=t._state.filter,l=t.selectedIndexes.slice(0);a&&t._applyFilter(a),t._checkOverflow(),t.selectedIndexes=[],t._applySelection(!0,l)}}},{key:"saveState",value:function(){var e=this;return e.id?window.localStorage.setItem("jqxTree"+e.id,JSON.stringify(e._state)):e.warn(e.localize("noId")),JSON.parse(JSON.stringify(e._state))}},{key:"select",value:function(e){var t=this;void 0===(e=t.getItem(e))||e.selected||e.templateApplied||t._handleSelection(e,{type:"programmatic"})}},{key:"unselect",value:function(e){var t=this;void 0!==(e=t.getItem(e))&&e.selected&&!e.templateApplied&&t._handleSelection(e,{type:"programmatic"})}},{key:"updateItem",value:function(e,t){if(void 0!==(e=this.getItem(e))&&void 0!==t){var r=e instanceof JQX.TreeItem;for(var n in t)if(t.hasOwnProperty(n)){if(r){if(-1===["disabled","label","level","selected","separator","shortcut","value"].indexOf(n))continue}else if(-1===["disabled","expanded","label","level","selected","separator","value"].indexOf(n))continue;e[n]=t[n]}}}},{key:"propertyChangedHandler",value:function(e,t,r){var n=this;switch(e){case"allowDrag":case"allowDrop":case"autoLoadState":case"autoSort":case"editable":case"filterInputPlaceholder":case"loadingIndicatorPlaceholder":case"selectionDisplayMode":case"showLines":case"showRootLines":case"toggleElementPosition":case"toggleMode":break;case"autoHideToggleElement":r?n.$mainContainer.addClass("hidden-arrows"):n.$mainContainer.removeClass("hidden-arrows");break;case"autoSaveState":if(!r)return;if(!n.id)return n.warn(n.localize("noId")),void(n.autoSaveState=!1);window.localStorage.setItem("jqxTree"+n.id,JSON.stringify(n._state));break;case"dataSource":var a=n.selectedIndexes.slice(0);n.selectedIndexes=[],n._menuItems={},n._processDataSource(),n._checkOverflow(),n._expandItemsByDefault(),n._applySelection(!0,a);var l=n._state.filter;l&&n._applyFilter(l);break;case"disabled":n._setFocusable(),n.$.scrollButtonNear.disabled=r,n.$.scrollButtonFar.disabled=r,r||n._updateScrollButtonVisibility();break;case"displayLoadingIndicator":r?(n._discardKeyboardHover(!0),n.$loadingIndicatorContainer.removeClass("jqx-hidden")):n.$loadingIndicatorContainer.addClass("jqx-hidden");break;case"filterable":!1===r&&(n._applyFilter(""),n.$.filterInput.value=""),n._checkOverflow();break;case"filterMode":n.filterable&&n._state.filter&&n._applyFilter(n._state.filter);break;case"hasThreeStates":if("checkBox"!==n.selectionMode)return;if(r)n._applySelection(!1);else for(var o=(n.enableShadowDOM?n.shadowRoot:n).querySelectorAll("[indeterminate]"),i=0;i<o.length;i++)o[i].removeAttribute("indeterminate");break;case"loadingIndicatorPosition":"center"===r?n.$loadingIndicatorPlaceHolder.addClass("jqx-hidden"):n.$loadingIndicatorPlaceHolder.removeClass("jqx-hidden");break;case"overflow":if("scrollbar"===n.scrollMode)return void(n.$.scrollViewer.verticalScrollBarVisibility="scroll"===r?"visible":"auto");n.$.scrollViewer.scrollTop=0,"hidden"===r?(n.$scrollViewer.removeClass("scroll-buttons-shown"),n.$scrollButtonNear.addClass("jqx-hidden"),n.$scrollButtonFar.addClass("jqx-hidden")):(n.$.scrollButtonNear.disabled=n.disabled,n.$.scrollButtonFar.disabled=n.disabled,"auto"===r?(n.$scrollButtonNear.addClass("jqx-hidden"),n.$scrollButtonFar.addClass("jqx-hidden"),n._checkOverflow()):(n.$scrollViewer.addClass("scroll-buttons-shown"),n.$scrollViewer.removeClass("one-button-shown"),n.$scrollButtonNear.removeClass("jqx-hidden"),n.$scrollButtonFar.removeClass("jqx-hidden"),n._updateScrollButtonVisibility())),n.$.scrollViewer.refresh();break;case"rightToLeft":var s=void 0,d=void 0;r?(s="paddingLeft",d="paddingRight"):(s="paddingRight",d="paddingLeft");for(var c in n._menuItems)if(n._menuItems.hasOwnProperty(c)){var u=n._menuItems[c],v=u.firstElementChild;v.style[s]="",n._setIndentation(v,u.level,d)}break;case"scrollMode":if("hidden"===n.overflow)return;if(n.$.scrollViewer.scrollTop=0,"scrollButtons"===r)return"scroll"===n.overflow&&(n.$scrollViewer.addClass("scroll-buttons-shown"),n.$scrollButtonNear.removeClass("jqx-hidden"),n.$scrollButtonFar.removeClass("jqx-hidden")),n.$.scrollViewer.verticalScrollBarVisibility="auto",void n._checkOverflow();n.$scrollViewer.removeClass("scroll-buttons-shown"),n.$scrollViewer.removeClass("one-button-shown"),n.$scrollButtonNear.addClass("jqx-hidden"),n.$scrollButtonFar.addClass("jqx-hidden"),"auto"===n.overflow?n.$.scrollViewer.verticalScrollBarVisibility="auto":n.$.scrollViewer.verticalScrollBarVisibility="visible";break;case"selectedIndexes":n._applySelection(!1,t);break;case"selectionMode":if(void 0===n._menuItems[0])return;if("one"===t&&"none"!==r&&"checkBox"!==r&&"radioButton"!==r||-1!==t.indexOf("oneOrMany")&&-1!==r.indexOf("oneOrMany")||"none"===t&&(-1!==r.indexOf("zero")||"checkBox"===r)||"zeroOrMany"===r&&"checkBox"!==t||"radioButton"===t&&-1!==r.indexOf("Many")||!n.hasThreeStates&&("checkBox"===r||"checkBox"===t&&"zeroOrMany"===r))return void(n._lastSelectedItem="one"===r||"oneOrManyExtended"===r?n._menuItems[n.selectedIndexes[n.selectedIndexes.length-1]]:void 0);if(n.hasThreeStates&&"checkBox"===t)for(var p=(n.enableShadowDOM?n.shadowRoot:n).querySelectorAll("[indeterminate]"),m=0;m<p.length;m++)p[m].removeAttribute("indeterminate");n._applySelection(!1);break;case"sort":if(!n.sorted)return;n._refreshSorting();break;case"sortDirection":n.sorted&&!n.sort&&(n._unsortItems(n.$.mainContainer),n._applyGrouping(n.$.mainContainer));break;case"sorted":if(!r&&!n.autoSort)return n._refreshItemPathsAndSelection(),void n._updateState("sorted",!1);r?n._applyGrouping(n.$.mainContainer):n._unsortItems(n.$.mainContainer);var h=n._state.filter;h&&n._applyFilter(h),n._updateState("sorted",r),n._checkOverflow();break;case"unfocusable":n._setFocusable()}}},{key:"_addDragFeedback",value:function(){var e=this,t=document.createElement("div");return t.className="jqx-tree-item-feedback",t.setAttribute("parent-tree-id",e.id),e.theme&&t.classList.add(e.theme),e.dragFeedbackFormatFunction?t.innerHTML=e.dragFeedbackFormatFunction(e._dragDetails.Items):1===e._dragDetails.Items.length?t.innerHTML=e._dragDetails.Item.label:(t.classList.add("multiple"),t.innerHTML="&#xf0c5;"),document.body.appendChild(t),t}},{key:"_applyFilter",value:function(e){function t(e,t){e?(t.hidden&&t.$.removeClass("jqx-hidden"),t.hidden=!1):(t.hidden||t.$.addClass("jqx-hidden"),t.hidden=!0)}function r(a,l){var o=!1,i=0,s=void 0;l=Array.from(l);for(var d=0;d<l.length;d++){var c=l[d];c instanceof JQX.TreeItem?t(n._findItem(c,e),c):r(c,c.itemContainer.children),c.hidden||(i++,s=c),o=o||!c.hidden}if(a!==n.$.mainContainer){var u=n._findItem(a,e);t(o||u,a),o&&null===u?a.$.addClass("filtered-child"):a.$.removeClass("filtered-child"),!o&&l.length>0?(a.hiddenChildren=!0,a.$.addClass("hidden-children"),n.collapseItem(a,void 0,!1)):(a.hiddenChildren=!1,a.$.removeClass("hidden-children"))}""!==e&&i>0&&s.$.addClass("last-filtered-child")}var n=this;if(""!==e||n.hasAttribute("filter-applied")){for(var a=Array.from(n.getElementsByClassName("last-filtered-child")),l=0;l<a.length;l++)a[l].$.removeClass("last-filtered-child");r(n.$.mainContainer,n.$.mainContainer.children),""!==e?n.setAttribute("filter-applied",""):n.removeAttribute("filter-applied"),n._updateState("filter",e),n._checkOverflow()}}},{key:"_applyHierarchicalSelection",value:function(e,t){for(var r=this,n=e!==r.$.mainContainer,a=n?e.itemContainer.children:e.children,l=0,o=0,i=0;i<a.length;i++){var s=a[i];e.selected&&s.set("selected",!0),s instanceof JQX.TreeItemsGroup?r._applyHierarchicalSelection(s,t):s.selected&&t.push(s.path),n&&(s.selected?l++:s.hasAttribute("indeterminate")&&o++)}n&&(r._setThreeStateCheckbox(e,l,o),e.selected&&t.push(e.path))}},{key:"_applyRadioButtonSelection",value:function(e,t,r){for(var n=this,a=e!==n.$.mainContainer?e.itemContainer.children:e.children,l=[],o=void 0,i=0;i<a.length;i++){var s=a[i];s instanceof JQX.TreeItemsGroup&&n._applyRadioButtonSelection(s,t,r),s.set("selected",!1),-1!==t.indexOf(s.path)&&l.push(s)}o=0===l.length?a[0]:l[l.length-1],o.set("selected",!0),r.push(o.path)}},{key:"_applySelection",value:function(e,t){var r=this,n=r.selectedIndexes.slice(0);if(void 0===t&&(t=n.slice(0)),void 0===r._menuItems[0])return r.selectedIndexes=[],r._lastSelectedItem=void 0,void(r.isCompleted&&JSON.stringify(t)!==JSON.stringify([])&&r.$.fireEvent("change",{selectedIndexes:r.selectedIndexes,oldSelectedIndexes:t}));for(var a=r.selectionMode,l=Array.from((r.enableShadowDOM?r.shadowRoot:r).querySelectorAll("jqx-tree-item[selected], jqx-tree-items-group[selected]")),o=n.length-1;o>=0;o--){void 0===r._menuItems[n[o]]&&n.splice(o,1)}if(e)for(var i=0;i<l.length;i++)-1===n.indexOf(l[i].path)&&n.push(l[i].path);else{for(var s=0;s<l.length;s++)l[s].set("selected",!1);l.length=0}switch(r._sortPathCollection(n),a){case"none":n.length=0;for(var d=0;d<l.length;d++)l[d].set("selected",!1);break;case"one":case"zeroOrOne":"zeroOrOne"!==a&&0===n.length&&n.push("0");for(var c=0;c<n.length;c++){var u=r._menuItems[n[c]];if(c===n.length-1){u.set("selected",!0),n=[n[c]];break}-1!==l.indexOf(u)&&u.set("selected",!1)}break;case"oneOrMany":case"oneOrManyExtended":0===n.length&&n.push("0");for(var v=0;v<n.length;v++)r._menuItems[n[v]].set("selected",!0);break;case"zeroOrMany":case"checkBox":for(var p=0;p<n.length;p++)r._menuItems[n[p]].set("selected",!0);if("checkBox"===a&&r.hasThreeStates){var m=[];r._applyHierarchicalSelection(r.$.mainContainer,m),r._sortPathCollection(m),n=m}break;case"radioButton":var h=[];r._applyRadioButtonSelection(r.$.mainContainer,n,h),r._sortPathCollection(h),n=h}r.selectedIndexes=n,r._updateState("selected"),r._lastSelectedItem="one"===a||"oneOrManyExtended"===a?r._menuItems[n[n.length-1]]:void 0,r.isCompleted&&!1!==arguments[2]&&JSON.stringify(t)!==JSON.stringify(n)&&r.$.fireEvent("change",{selectedIndexes:r.selectedIndexes,oldSelectedIndexes:t})}},{key:"_autoLoadState",value:function(e){for(var t=this,r=[],n=0;n<t._menuItemsGroupsToExpand.length;n++)t._menuItemsGroupsToExpand[n].set("expanded",!1);t._menuItemsGroupsToExpand=[];for(var a=0;a<e.expanded.length;a++){var l=t.getItem(e.expanded[a]);l&&t._menuItemsGroupsToExpand.push(l)}t.filterable&&e.filter&&(t._applyFilter(e.filter),t.$.filterInput.value=e.filter);for(var o=0;o<e.selected.length;o++){var i=t.getItem(e.selected[o]);i&&r.push(i.path)}t.selectedIndexes=r}},{key:"_blurHandler",value:function(){this._discardKeyboardHover(!0)}},{key:"_canItemBeHovered",value:function(e){var t=e.level;return!1===e.disabled&&!0!==e.templateApplied&&!0!==e.hidden&&(1===t||t>1&&this._isContainerOpened(t,e.parentElement.container)&&e.getBoundingClientRect().height>0)}},{key:"_canItemBeSelected",value:function(e){return!1===e.disabled&&!0!==e.templateApplied}},{key:"_checkOverflow",value:function(){var e=this,t=e.$.scrollViewer,r=e.overflow;if("scrollbar"===e.scrollMode||"hidden"===r)return void t.refresh();var n=t.scrollTop;"auto"===r&&(t.$.removeClass("scroll-buttons-shown"),t.$.removeClass("one-button-shown"),e.$scrollButtonNear.addClass("jqx-hidden"),e.$scrollButtonFar.addClass("jqx-hidden"));var a=Math.round(t.$.scrollViewerContentContainer.offsetHeight)>Math.round(t.$.scrollViewerContainer.offsetHeight),l=Math.round(t.scrollTop)>0,o=Math.round(t.$.scrollViewerContainer.offsetHeight+t.scrollTop)<Math.round(t.$.scrollViewerContentContainer.offsetHeight);a?"auto"===r?(t.$.addClass("scroll-buttons-shown"),l&&e.$scrollButtonNear.removeClass("jqx-hidden"),o&&e.$scrollButtonFar.removeClass("jqx-hidden"),!1===(l&&o)&&t.$.addClass("one-button-shown"),e.disabled||(e.$.scrollButtonNear.disabled=!1,e.$.scrollButtonFar.disabled=!1),t.scrollTop=n):(e.$scrollButtonNear.removeClass("jqx-hidden"),e.$scrollButtonFar.removeClass("jqx-hidden"),e.disabled?(e.$.scrollButtonNear.disabled=!0,e.$.scrollButtonFar.disabled=!0):(e.$.scrollButtonNear.disabled=!l,e.$.scrollButtonFar.disabled=!o)):"scroll"===r&&(e.$.scrollButtonNear.disabled=!0,e.$.scrollButtonFar.disabled=!0),t.refresh()}},{key:"_createElement",value:function(){var e=this,t=window.getComputedStyle(e.$.scrollViewer);e.$.scrollViewer.onVerticalChange=e._verticalScrollbarHandler,Object.defineProperty(e,"dataSource",{get:function(){return e.context===e?e.properties.dataSource.value:e._getDataSource()},set:function(t){e.updateProperty(e,e._properties.dataSource,t)}}),e.id||!e.autoLoadState&&!e.autoSaveState||(e.warn(e.localize("noId")),e.autoLoadState=!1,e.autoSaveState=!1),e.mode="tree",e._element="tree",e._isMobile=JQX.Utilities.Core.isMobile,e._edgeMacFF=!1,e._autoScrollCoefficient=JQX.Utilities.Core.Browser.Firefox?4:JQX.Utilities.Core.Browser.Edge?8:2,e._scrollViewerPadding=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)||0,e._state={expanded:[],filter:"",selected:[]},e._dblclickObject={numberOfClicks:0},e.autoHideToggleElement&&e.$mainContainer.addClass("hidden-arrows"),e.disabled&&(e.$.scrollButtonNear.disabled=!0,e.$.scrollButtonFar.disabled=!0),"scrollbar"===e.scrollMode&&"scroll"===e.overflow&&(e.$.scrollViewer.verticalScrollBarVisibility="visible"),null===e.dataSource&&e.$.mainContainer.firstElementChild instanceof HTMLUListElement&&e._processUList();var r=e.getElementsByTagName("jqx-tree-item"),n=function(){var t=void 0;e.autoLoadState&&(t=window.localStorage.getItem("jqxTree"+e.id))&&(t=JSON.parse(t),e.sorted=t.sorted),e._setFocusable(),e._menuItems={},null===e.dataSource?e._processHTML(e.$.mainContainer,1):e._processDataSource(),"scrollButtons"===e.scrollMode&&"scroll"===e.overflow&&(e.$scrollViewer.addClass("scroll-buttons-shown"),e.$scrollButtonNear.removeClass("jqx-hidden"),e.$scrollButtonFar.removeClass("jqx-hidden"),e._updateScrollButtonVisibility()),e._checkOverflow(),t&&e._autoLoadState(t),e._expandItemsByDefault(),e._applySelection(!0),e._updateState("sorted",e.sorted),e.displayLoadingIndicator&&e.$loadingIndicatorContainer.removeClass("jqx-hidden"),"center"!==e.loadingIndicatorPosition&&e.$loadingIndicatorPlaceHolder.removeClass("jqx-hidden"),e.__onCompleted&&(e._onCompleted=e.__onCompleted,e.__onCompleted=null,e._onCompleted())};0===r.length?n():(e._onCompleted&&(e.__onCompleted=e._onCompleted,e._onCompleted=null),e._ensureItemsReady(r,n))}},{key:"_dblclickHandler",value:function(e,t,r){var n=this;"dblclick"!==n.toggleMode||e instanceof JQX.TreeItem||t||n._menuItemsGroupSelectionHandler(e,r)}},{key:"_discardKeyboardHover",value:function(e,t){var r=this;!t&&r._hoveredViaKeyboard&&(!e&&r._hoveredViaKeyboard instanceof JQX.MenuItemsGroup&&r._isContainerOpened(r._hoveredViaKeyboard.level+1,r._hoveredViaKeyboard.container)||(r._hoveredViaKeyboard.removeAttribute("focus"),r._hoveredViaKeyboard=void 0))}},{key:"_documentUpHandler",value:function(e){var t=this,r=t._downItem,n=t.enableShadowDOM?e.originalEvent.composedPath()[0]:e.originalEvent.target;if(delete t._downItem,t._editedItem&&!t._editInputDown&&(!t._isMobile&&n!==t.$.editInput||t._isMobile&&document.elementFromPoint(e.clientX,e.clientY)!==t.$.editInput))return void t._endEditing();if(delete t._editInputDown,r){var a=n.closest("jqx-tree-item")||n.closest("jqx-tree-items-group");!a||!a.selected||a!==r||t._dragDetails&&t._dragDetails.FeedbackShown||a instanceof JQX.TreeItemsGroup&&(n.closest(".jqx-tree-items-group-arrow")||n===a.container||n===a.container.firstElementChild)||t._handleSelection(a,e)}var l=t._dragDetails;if(l){var o=JQX.Tree.hoveredTree,i=JQX.Tree.hoveredItem;if(delete t._dragDetails,delete JQX.Tree.treeItemDragged,delete JQX.Tree.hoveredTree,delete JQX.Tree.hoveredItem,t.$.scrollViewer._scrollView.disableSwipeScroll=!1,l.FeedbackShown){var s=o||document.elementFromPoint(e.clientX,e.clientY),d=void 0;document.body.classList.remove("jqx-dragging"),document.body.removeChild(l.Feedback),o&&clearInterval(o._dragInterval);var c=l.Item,u=l.Items,v=l.ValidItems;if(s){if(!i||c.contains(i))return void t.$.fireEvent("dragEnd",{item:c,items:u,target:s,data:l,previousContainer:t,container:o||s,originalEvent:e});if(o&&o.allowDrop&&!o.disabled){var p=[o],m=void 0;if(i.classList.remove("drop-target"),i.classList.contains("top")?(i.classList.remove("top"),m="top",d=0):i.classList.contains("bottom")?(i.classList.remove("bottom"),m="bottom",d=2):(m="inside",d=1),l.DropDetails={item:i,position:m},o!==t)p.push(t);else if(l.ValidateOnDrop)for(var h=0;h<v.length;h++)if(v[h].contains(i))return;if(!t.$.fireEvent("dragEnd",{item:c,items:u,target:i,data:l,previousContainer:t,container:o,originalEvent:e}).defaultPrevented){o.sorted&&o.autoSort&&o._unsortItems(o.$.mainContainer);for(var f=0;f<v.length;f++)t._moveTreeItem(v[f],i,d,p);o.sorted&&o.autoSort&&o._applyGrouping(o.$.mainContainer),o!==t&&o._state.filter&&o._applyFilter(o._state.filter)}}}}}}},{key:"_editInputBlurHandler",value:function(){this._endEditing()}},{key:"_endEditing",value:function(e){var t=this,r=t._editedItem;if(r&&(delete t._editedItem,t.$editInput.addClass("jqx-hidden"),t.focus(),!e)){var n=t.$.editInput.value,a=t.sorted&&t.autoSort,l=t._state.filter;n!==r.label&&(r.set("label",n),r.firstElementChild.firstElementChild.firstElementChild.innerHTML=n,a&&(t._unsortItems(t.$.mainContainer),t._applyGrouping(t.$.mainContainer)),l&&t._applyFilter(l))}}},{key:"_ensureVisible",value:function(e){var t=this;t._ensureVisibleTreeMode(e,e.getBoundingClientRect(),t.$.scrollViewer,t.$.scrollViewer.getBoundingClientRect(),t._scrollViewerPadding),t._ensureVisibleCallback&&t._ensureVisibleCallback(e)}},{key:"_filterInputKeydownHandler",value:function(e){if("PageDown"!==e.key)return void("PageUp"===e.key&&(e.preventDefault(),e.stopPropagation()));var t=this,r=void 0;if(e.preventDefault(),e.stopPropagation(),t.selectedIndexes.length>0){var n=t.selectedIndexes.slice(0);r=t._lastSelectedItem||t._menuItems[t.selectedIndexes[t.selectedIndexes.length-1]],"checkBox"!==t.selectionMode&&"radioButton"!==t.selectionMode&&(t.selectedIndexes=[r.path],t._applySelection(!1,n)),t.focus()}else r=t._getFirstEnabledChild(t.$.mainContainer),t.focus(),r&&t._hoverViaKeyboard(r);t._ensureVisible(r)}},{key:"_focusHandler",value:function(){var e=this;e.selectedIndexes.length>0&&!e._hoveredViaKeyboard&&(e._lastSelectedItem?e._hoverViaKeyboard(e._lastSelectedItem,!1,void 0,!1):e._hoverViaKeyboard(e._menuItems[e.selectedIndexes[e.selectedIndexes.length-1]],!1,void 0,!1))}},{key:"_getDataSource",value:function(){function e(t,r){for(var n=0;n<t.length;n++){var a=t[n],l={label:a.label};a.disabled&&(l.disabled=!0),a.selected&&(l.selected=!0),a.separator&&(l.separator=!0),null!==a.value&&(l.value=a.value),a instanceof JQX.TreeItem?a.shortcut&&(l.shortcut=a.shortcut):(a.expanded&&(l.expanded=!0),l.items=[],e(a.itemContainer.children,l.items)),r.push(l)}}var t=this,r=[];return e(t.$.mainContainer.children,r),r}},{key:"_handleHierarchicalSelection",value:function(e,t){function r(e,t){for(var n=e.itemContainer.children,a=0;a<n.length;a++){var l=n[a];l.set("selected",t),l.removeAttribute("indeterminate"),l instanceof JQX.TreeItemsGroup&&r(l,t)}}var n=this,a=e;for(e.selected?e.set("selected",!1):(e.set("selected",!0),e.removeAttribute("indeterminate"));a.parentItem;){for(var l=a.parentItem,o=l.itemContainer.children,i=0,s=0,d=0;d<o.length;d++)o[d].selected?i++:o[d].hasAttribute("indeterminate")&&s++;n._setThreeStateCheckbox(l,i,s),a=l}e instanceof JQX.TreeItemsGroup&&r(e,e.selected),t.length=0;for(var c=Array.from((n.enableShadowDOM?n.shadowRoot:n).querySelectorAll("[selected]")),u=0;u<c.length;u++)t.push(c[u].path);n._sortPathCollection(t)}},{key:"_handleSelection",value:function(e,t){var r=this,n=r.selectionMode;if("none"!==n&&("programmatic"===t.type||r._canItemBeSelected(e))){var a=e.selected;if(!a||"down"!==t.type){var l=r.selectedIndexes.slice(0),o=l.slice(0);switch(n){case"one":if(a)return;r._menuItems[o[0]].set("selected",!1),r.selectedIndexes=[e.path],e.set("selected",!0),r._lastSelectedItem=e;break;case"zeroOrOne":a?(r.selectedIndexes=[],e.set("selected",!1)):(void 0!==o[0]&&r._menuItems[o[0]].set("selected",!1),r.selectedIndexes=[e.path],e.set("selected",!0));break;case"oneOrMany":case"zeroOrMany":if(a){if(1===o.length&&"zeroOrMany"!==n)return;o.splice(o.indexOf(e.path),1),e.set("selected",!1)}else o.push(e.path),r._sortPathCollection(o),e.set("selected",!0);r.selectedIndexes=o;break;case"oneOrManyExtended":var i=t.ctrlKey,s=t.shiftKey;if(!i&&!s||s&&e===r._lastSelectedItem){for(var d=0;d<o.length;d++)r._menuItems[o[d]].set("selected",!1);o=[e.path],e.set("selected",!0),r._lastSelectedItem=e}else if(i)e.selected&&o.length>1?(o.splice(o.indexOf(e.path),1),e.set("selected",!1)):e.selected||(o.push(e.path),r._sortPathCollection(o),e.set("selected",!0),r._lastSelectedItem=e);else if(s){for(var c=0;c<o.length;c++)r._menuItems[o[c]].set("selected",!1);o=r._selectItemRange(r._lastSelectedItem,e)}r.selectedIndexes=o;break;case"checkBox":r.hasThreeStates?r._handleHierarchicalSelection(e,o):a?(o.splice(o.indexOf(e.path),1),e.set("selected",!1)):(o.push(e.path),r._sortPathCollection(o),e.set("selected",!0)),r.selectedIndexes=o;break;case"radioButton":if(e.selected)return;for(var u=void 0,v=0;v<e.parentElement.children.length;v++){var p=e.parentElement.children[v];if(p.selected){u=p;break}}var m=o.indexOf(u.path);u.set("selected",!1),e.set("selected",!0),o.splice(m,1),o.push(e.path),r._sortPathCollection(o),r.selectedIndexes=o}if(r._discardKeyboardHover(!0),r._hoverViaKeyboard(e,!1,void 0,!r._treeAnimationInProgress),r._updateState("selected"),JSON.stringify(l)!==JSON.stringify(r.selectedIndexes)){if(r.ownerElement&&!r.ownerElement.isCompleted)return;r.$.fireEvent("change",{item:e,selectedIndexes:r.selectedIndexes,oldSelectedIndexes:l})}}}}},{key:"_hoverViaKeyboard",value:function(e,t,r,n){if(e){var a=this;e.setAttribute("focus",""),a._hoveredViaKeyboard=e,!1!==n&&a._ensureVisible(e),t&&a._handleSelection(e,r),a._hoverViaKeyboardCallback&&a._hoverViaKeyboardCallback(e)}}},{key:"_keydownHandler",value:function(e){function t(t){for(var r=t;r<o.length;r++){var n=o[r]
;if(a._canItemBeHovered(n)){if(s){if(s===n)break;s.removeAttribute("focus")}a._hoverViaKeyboard(n,i,e);break}}}function r(t){for(var r=t;r>=0;r--){var n=o[r];if(a._canItemBeHovered(n)){if(s){if(s===n)break;s.removeAttribute("focus")}a._hoverViaKeyboard(n,i,e);break}}}function n(){s.level>1&&(s.removeAttribute("focus"),a._hoverViaKeyboard(s.parentItem,i,e))}var a=this,l=e.key;if(a._editedItem)return void("Enter"===l?a._endEditing():"Escape"===l&&a._endEditing(!0));if(document.activeElement===a&&-1!==["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Enter","F2","Home","PageDown","PageUp"," "].indexOf(l)&&!a.disabled&&!a.displayLoadingIndicator){e.preventDefault();var o=Array.from(a.$.mainContainer.querySelectorAll("jqx-tree-item, jqx-tree-items-group")),i="one"===a.selectionMode||"oneOrManyExtended"===a.selectionMode&&!e.ctrlKey,s=a.$.mainContainer.querySelector("[focus]"),d=void 0;switch(l){case"ArrowDown":d=s?o.indexOf(s)+1:0,t(d);break;case"ArrowLeft":if(!s)return;if(s instanceof JQX.TreeItem)n();else{if(a._isContainerOpened(s.level+1,s.container))return void a._closeSubContainersTreeMode(s.level+1,s.container,!0,!0);n()}break;case"ArrowRight":if(!s||s instanceof JQX.TreeItem)return;a._isContainerOpened(s.level+1,s.container)?(s.removeAttribute("focus"),a._hoverViaKeyboard(a._getFirstEnabledChild(s.itemContainer),i,e)):a._menuItemsGroupSelectionHandler(s,{target:s,type:"keydown"});break;case"ArrowUp":d=s?o.indexOf(s)-1:o.length-1,r(d);break;case"End":r(o.length-1);break;case"Enter":s&&s instanceof JQX.TreeItemsGroup&&a._menuItemsGroupSelectionHandler(s,{target:s,type:"keydown"});break;case"F2":a.editable&&a._startEditing(s);break;case"Home":t(0);break;case"PageDown":a._pageDownHandler(o,s,i,e);break;case"PageUp":a._pageUpHandler(o,s,i,e);break;case" ":s&&a._handleSelection(s,e)}}}},{key:"_mainContainerSwipeHandler",value:function(e){JQX.Tree.treeItemDragged&&e.stopPropagation()}},{key:"_menuItemsGroupSelectionHandler",value:function(e,t,r){var n=this,a=n.toggleMode,l=!!t.originalEvent&&t.originalEvent.target.classList.contains("jqx-tree-items-group-arrow"),o=e.container;if(!(n._waitAnimation&&n._treeAnimationInProgress===o||("down"!==t.type||l||"dblclick"===a&&1!==n._dblclickObject.numberOfClicks||n._handleSelection(e,t),"down"===t.type&&!l&&("dblclick"===a&&2!==n._dblclickObject.numberOfClicks||"click"===a&&n._dblclickObject.numberOfClicks>1||"arrow"===a)||e.hiddenChildren))){var i=o.level,s=n.hasAnimation;if("keydown"===t.type&&n._discardKeyboardHover(),n._treeAnimationInProgress&&(o.removeEventListener("transitionend",n._transitionendHandlerExpand),o.removeEventListener("transitionend",n._transitionendHandlerCollapse)),n._isContainerOpened(i,o))n._closeSubContainersTreeMode(i,o,!0,!1!==r);else{if(n.$.fireEvent("expanding",{item:e,label:e.label,path:e.path,value:e.value,children:e.itemContainer.children}).defaultPrevented)return;if(s&&("expand"!==t.type&&(n._ensureVisibleOnTransitionend=e),n._expandSection(o)),o.$.removeClass("jqx-visibility-hidden"),"keydown"===t.type&&(e.setAttribute("focus",""),n._hoveredViaKeyboard=e),e.$.addClass("jqx-tree-items-group-opened"),e.$.addClass("jqx-tree-items-group-expanded"),n._addOpenedContainer(i,o),void 0===t.type&&n._hoverViaKeyboard(n._getFirstEnabledChild(e.itemContainer)),!1!==r){var d={item:e,label:e.label,path:e.path,value:e.value,children:e.itemContainer.children};n.toggleCallback?(d.type="expand",n.toggleCallback(d)):n.$.fireEvent("expand",d)}}s||(n._checkOverflow(),"expand"!==t.type&&n._ensureVisible(e))}}},{key:"_mouseenterHandler",value:function(){var e=this;e.autoHideToggleElement&&e.$mainContainer.removeClass("hidden-arrows"),JQX.Tree.treeItemDragged&&e.allowDrop&&!e.disabled&&(JQX.Tree.hoveredTree=e)}},{key:"_mouseleaveHandler",value:function(){var e=this;if(e.autoHideToggleElement&&e.$mainContainer.addClass("hidden-arrows"),JQX.Tree.treeItemDragged){JQX.Tree.hoveredTree&&(clearInterval(JQX.Tree.hoveredTree._dragInterval),delete JQX.Tree.hoveredTree);var t=JQX.Tree.hoveredItem;t&&(t.classList.remove("drop-target"),t.classList.remove("top"),t.classList.remove("bottom"),delete JQX.Tree.hoveredItem)}}},{key:"_moveHandler",value:function(e){var t=this,r=t._dragDetails;if(r){if(!r.FeedbackShown){if(!(Math.abs(r.StartPosition.left-e.pageX)>5||Math.abs(r.StartPosition.top-e.pageY)>5))return;if(t.$.fireEvent("dragStart",{item:r.Item,items:r.Items,data:r,container:t,previousContainer:t,originalEvent:r.OriginalEvent}).defaultPrevented)return delete t._dragDetails,delete JQX.Tree.treeItemDragged,delete JQX.Tree.hoveredTree,delete JQX.Tree.hoveredItem,void(t.$.scrollViewer._scrollView.disableSwipeScroll=!1);document.body.classList.add("jqx-dragging"),r.Feedback=t._addDragFeedback(),r.FeedbackShown=!0}var n=t.dragOffset,a=void 0,l=void 0,o=void 0;if(t.$.fireEvent("dragging",{item:r.Item,items:r.Items,data:r,originalEvent:e}),r.Feedback.style.left=e.pageX+n[0]+"px",r.Feedback.style.top=e.pageY+n[1]+"px",t._isMobile){var i=JQX.Tree.hoveredItem;i&&(i.classList.remove("drop-target"),i.classList.remove("top"),i.classList.remove("bottom"),delete JQX.Tree.hoveredItem);var s=document.elementFromPoint(e.clientX,e.clientY);JQX.Tree.hoveredTree&&(clearInterval(JQX.Tree.hoveredTree._dragInterval),delete JQX.Tree.hoveredTree),s&&(a=s.closest("jqx-tree"))&&a.allowDrop&&(JQX.Tree.hoveredTree=a,l=s.closest("jqx-tree-item")||s.closest("jqx-tree-items-group"),l?o=l:l=s)}if(a=JQX.Tree.hoveredTree){var d=a.filterable?a.$.filterInput.offsetHeight+10:0;if(clearInterval(a._dragInterval),a._dragInterval=setInterval(function(){var r=a.getBoundingClientRect();a.$.scrollViewer.scrollHeight>0&&r.left<=e.clientX&&r.left+r.width>=e.clientX?e.clientY>=r.top+d&&e.clientY<=r.top+20+d?(a.$.scrollViewer.scrollTop-=t._autoScrollCoefficient,"scrollButtons"===a.scrollMode&&a._updateScrollButtonVisibility()):e.clientY>=r.top+r.height-20&&e.clientY<=r.top+r.height?(a.$.scrollViewer.scrollTop+=t._autoScrollCoefficient,"scrollButtons"===a.scrollMode&&a._updateScrollButtonVisibility()):clearInterval(a._dragInterval):clearInterval(a._dragInterval)},1),t._isMobile||(l=e.originalEvent.target,l&&l.enableShadowDOM&&(l=e.originalEvent.composedPath()[0]),l&&l.closest&&(o=l.closest("jqx-tree-item")||l.closest("jqx-tree-items-group"))),o){if(JQX.Tree.hoveredItem&&o!==JQX.Tree.hoveredItem&&(JQX.Tree.hoveredItem.classList.remove("drop-target"),JQX.Tree.hoveredItem.classList.remove("top"),JQX.Tree.hoveredItem.classList.remove("bottom")),JQX.Tree.hoveredItem=o,r.Item.contains(o))return;var c=o.getBoundingClientRect();o instanceof JQX.TreeItem?e.clientY-c.top<=c.height/2?(o.classList.remove("bottom"),o.classList.add("top")):(o.classList.remove("top"),o.classList.add("bottom")):e.clientY-c.top<=10?(o.classList.remove("bottom"),o.classList.add("top")):!o.expanded&&c.bottom-e.clientY<=10?(o.classList.remove("top"),o.classList.add("bottom")):(o.classList.remove("top"),o.classList.remove("bottom")),o.classList.add("drop-target")}else if(JQX.Tree.hoveredItem&&(JQX.Tree.hoveredItem.classList.remove("drop-target"),JQX.Tree.hoveredItem.classList.remove("top"),JQX.Tree.hoveredItem.classList.remove("bottom")),l===a.$.scrollViewer.$.scrollViewerContainer)if(a._menuItems[0]){for(var u=a.$.mainContainer.lastElementChild,v=a.$.mainContainer.childElementCount-1;u.hidden&&(v--,u=a.$.mainContainer.children[v]););u?(JQX.Tree.hoveredItem=u,JQX.Tree.hoveredItem.classList.add("bottom")):JQX.Tree.hoveredItem=a.$.container,JQX.Tree.hoveredItem.classList.add("drop-target")}else JQX.Tree.hoveredItem=a.$.container,JQX.Tree.hoveredItem.classList.add("drop-target");else delete JQX.Tree.hoveredItem}}}},{key:"_moveSubItems",value:function(e,t,r){for(var n=this,a=0;a<e.length;a++){var l=e[a];l.menu=t,l.set("level",l.parentItem.level+1),l.firstElementChild.style.paddingLeft="",l.firstElementChild.style.paddingRight="",n._setIndentation(l.firstElementChild,l.level,r),l.hidden=!1,l.$.removeClass("jqx-hidden"),l.$.removeClass("filtered-child"),l.$.removeClass("last-filtered-child"),l instanceof JQX.TreeItemsGroup&&(l.$.removeClass("hidden-children"),l.container.level=l.level+1,n._moveSubItems(l.itemContainer.children,t,r),t!==n&&l.expanded&&(t._menuItemsGroupsToExpand.push(l),n._updateState("expanded",l.id,!1)))}}},{key:"_moveTreeItem",value:function(e,t,r,n){var a=this,l=e.level;if(0===r){if(t.previousElementSibling===e)return;t.parentElement.insertBefore(e,t),e.set("level",t.level)}else if(2===r){if(t.nextElementSibling===e)return;t.parentElement.insertBefore(e,t.nextElementSibling||null),e.set("level",t.level)}else if(t===n[0].$.container)n[0].$.mainContainer.appendChild(e),e.set("level",1);else{if(t.itemContainer.lastElementChild===e)return;t.itemContainer.appendChild(e),e.set("level",t.level+1)}var o=n[0].rightToLeft?"paddingRight":"paddingLeft";if(e.menu=n[0],e.parentItem=e.parentElement.menuItemsGroup,e.firstElementChild.style.paddingLeft="",e.firstElementChild.style.paddingRight="",a._setIndentation(e.firstElementChild,e.level,o),e.hidden=!1,e.$.removeClass("jqx-hidden"),e.$.removeClass("filtered-child"),e.$.removeClass("last-filtered-child"),e instanceof JQX.TreeItemsGroup&&(e.$.removeClass("hidden-children"),e.container.level=e.level+1,a._moveSubItems(e.itemContainer.children,n[0],o),e.expanded)){var i=a._openedContainers[l+1].indexOf(e.container);-1!==i&&a._openedContainers[l+1].splice(i,1),n[0]._menuItemsGroupsToExpand.push(e),2===n.length&&a._updateState("expanded",e.id,!1)}for(var s=0;s<n.length;s++){var d=n[s],c=d.context,u=d.selectedIndexes.slice(0);d.context=d,d._menuItems={},d._refreshItemPaths(d.$.mainContainer,!0,void 0,d.sorted&&!d.autoSort),d.selectedIndexes=[],d._applySelection(!0,u,!1),d._checkOverflow(),d.context=c}n[0]._expandItemsByDefault()}},{key:"_overriddenMenuHandler",value:function(){}},{key:"_pageDownHandler",value:function(e,t,r,n){function a(){for(var t=e.length-1;t>=0;t--){var r=e[t];if(l._canItemBeHovered(r)&&l._getOffsetTop(r)+r.firstElementChild.offsetHeight<=o.scrollTop+o.$.container.offsetHeight)return r}}var l=this,o=l.$.scrollViewer;if(t){var i=a();i&&(t!==i?(t.removeAttribute("focus"),l._hoverViaKeyboard(i,r,n)):o.scrollTop+o.$.container.offsetHeight!==o.$.scrollViewerContentContainer.offsetHeight&&(l.$.scrollViewer.scrollTop+=o.$.container.offsetHeight,"scrollButtons"===l.scrollMode&&l._updateScrollButtonVisibility(),i=a(),t.removeAttribute("focus"),l._hoverViaKeyboard(i,r,n)))}}},{key:"_pageUpHandler",value:function(e,t,r,n){function a(){for(var t=0;t<e.length;t++){var r=e[t];if(l._canItemBeHovered(r)&&l._getOffsetTop(r)>=o.scrollTop)return r}}var l=this,o=l.$.scrollViewer;if(t){var i=a();i&&(t!==i?(t.removeAttribute("focus"),l._hoverViaKeyboard(i,r,n)):0!==o.scrollTop?(l.$.scrollViewer.scrollTop-=o.$.container.offsetHeight,"scrollButtons"===l.scrollMode&&l._updateScrollButtonVisibility(),i=a(),t.removeAttribute("focus"),l._hoverViaKeyboard(i,r,n)):l.filterable&&l.$.filterInput.focus())}}},{key:"_refreshItemPathsAndSelection",value:function(){var e=this,t=e.selectedIndexes.slice(0);e._menuItems={},e._refreshItemPaths(e.$.mainContainer,!0),e.selectedIndexes=[],e._applySelection(!0,t)}},{key:"_refreshSorting",value:function(){var e=this;e._unsortItems(e.$.mainContainer),e._applyGrouping(e.$.mainContainer);var t=e._state.filter;t&&e._applyFilter(t),e._checkOverflow()}},{key:"_scroll",value:function(e){var t=this;t.$.scrollViewer.scrollTop=t.$.scrollViewer.scrollTop+10*e,t._updateScrollButtonVisibility(),t.focus()}},{key:"_scrollButtonFarClickHandler",value:function(){var e=this;e.$.scrollButtonFar.disabled||e._scroll(1)}},{key:"_scrollButtonNearClickHandler",value:function(){var e=this;e.$.scrollButtonNear.disabled||e._scroll(-1)}},{key:"_scrollViewerDownHandler",value:function(e){function t(){var t=n.closest("jqx-tree-item")||n.closest("jqx-tree-items-group");if(t&&r._canItemBeSelected(t)){var a=n.closest(".jqx-tree-items-group-arrow"),l=void 0;if(t instanceof JQX.TreeItem)l="_handleSelection";else{if(n===t.container||n===t.container.firstElementChild)return;l="_menuItemsGroupSelectionHandler"}if(clearTimeout(r._dblclickTimeout),t!==r._dblclickObject.target&&(r._dblclickObject.numberOfClicks=0),r._dblclickObject.target=t,r._dblclickObject.numberOfClicks++,r._dblclickTimeout=setTimeout(function(){r._dblclickObject.numberOfClicks=0},300),2===r._dblclickObject.numberOfClicks){if(r.editable)return void r._startEditing(t);r._dblclickHandler(t,a,e),r._dblclickObject.numberOfClicks=0}t.selected&&(r._downItem=t),r[l](t,e),r._discardKeyboardHover(!0),r._hoverViaKeyboard(t,!1,void 0,!1),a||r._startDragging(t,e)}}var r=this;if(!(e.target!==r.$.scrollViewer||r.disabled||r.displayLoadingIndicator||!r._isMobile&&1!==e.which)){var n=e.originalEvent.target;if(n===r.$.editInput)return void(r._editInputDown=!0);if(r._isMobile){var a=r.$.scrollViewer.scrollTop;setTimeout(function(){if(r.$.scrollViewer.scrollTop===a){var e=r.context;r.context=r,t(),r.context=e}},250)}else t()}}},{key:"_scrollViewerWheelHandler",value:function(){var e=this;"scrollButtons"===e.scrollMode&&"hidden"!==e.overflow&&e._updateScrollButtonVisibility()}},{key:"_selectItemRange",value:function(e,t){for(var r=this,n=Array.from(r.$.mainContainer.querySelectorAll("jqx-tree-item, jqx-tree-items-group")),a=n.indexOf(e),l=n.indexOf(t),o=[],i=Math.min(a,l);i<=Math.max(a,l);i++){var s=n[i];r._canItemBeHovered(s)&&(o.push(s.path),s.set("selected",!0))}return o}},{key:"_setFocusable",value:function(){babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_setFocusable",this).call(this);var e=this;if(e.disabled||e.unfocusable)return void(e.$.filterInput.tabIndex=-1);e.$.filterInput.removeAttribute("tabindex")}},{key:"_setIndentation",value:function(e,t,r){e.style[r]=20*t-10+"px"}},{key:"_setThreeStateCheckbox",value:function(e,t,r){t===e.itemContainer.childElementCount?(e.removeAttribute("indeterminate"),e.set("selected",!0)):0===t&&0===r?(e.removeAttribute("indeterminate"),e.set("selected",!1)):(e.setAttribute("indeterminate",""),e.set("selected",!1))}},{key:"_sortItems",value:function(e){var t=this;if(t.sorted){var r=void 0;e instanceof JQX.TreeItemsGroup?r=e.container.firstElementChild:e===t.$.mainContainer&&(r=e);var n=Array.from(r.children);if(t.sort){var a=t.sort(n,e);Array.isArray(a)&&(n=a)}else"asc"===t.sortDirection?n.sort(function(e,t){return e.label.localeCompare(t.label)}):n.sort(function(e,t){return t.label.localeCompare(e.label)});for(var l=n.length-1;l>=0;l--)r.insertBefore(n[l],r.firstElementChild)}}},{key:"_sortPathCollection",value:function(e){e.sort(function(e,t){for(var r=e.split("."),n=t.split("."),a=Math.max(r.length,n.length),l=0;l<a;l++){var o=parseFloat(r[l]),i=parseFloat(n[l]);if(isNaN(o))return-1;if(isNaN(i))return 1;if(o<i)return-1;if(o>i)return 1}})}},{key:"_startDragging",value:function(e,t){var r=this,n=r.selectionMode;if(r.allowDrag&&!r._editedItem&&"none"!==n){var a=[],l=[],o=void 0;if(-1!==["one","zeroOrOne","checkBox","radioButton"].indexOf(n))o=!1,a.push(e),l.push(e);else{o=!0;for(var i=0;i<r.selectedIndexes.length;i++)a.push(r._menuItems[r.selectedIndexes[i]]),l.push(a[i]);for(var s=0;s<a.length;s++){var d=a[s];if(-1!==l.indexOf(d))for(var c=l.length-1;c>=0;c--){var u=l[c];if(u===d)break;d.contains(u)&&l.splice(c,1)}}}r._dragDetails={StartPosition:{left:t.pageX,top:t.pageY},Items:a,ValidItems:l,Item:e,FeedbackShown:!1,ValidateOnDrop:o,OriginalEvent:t,StartTime:new Date,Dragging:!0},JQX.Tree.treeItemDragged=!0,r.$.scrollViewer._scrollView.disableSwipeScroll=!0,r.allowDrop&&(JQX.Tree.hoveredTree=r,JQX.Tree.hoveredItem=e)}}},{key:"_startEditing",value:function(e){var t=this,r=t.$.editInput,n=void 0,a=void 0;if(t._canItemBeSelected(e)){var l=e.firstElementChild,o=l.firstElementChild;t.rightToLeft?(n=function(){return l.offsetWidth-o.offsetLeft-o.offsetWidth},a="paddingRight"):(n=function(){return o.offsetLeft+parseFloat(window.getComputedStyle(l).borderLeftWidth)},a="paddingLeft"),e instanceof JQX.TreeItemsGroup?(r.style[a]=n()+(t.showLines?parseFloat(window.getComputedStyle(o.firstElementChild).paddingLeft):0)-1+"px",r.style.height=l.offsetHeight+"px"):(r.style[a]=e.offsetWidth+parseInt(l.style[a],10)-l.offsetWidth+parseFloat(window.getComputedStyle(o.firstElementChild).paddingLeft)-2+"px",r.style.height=e.offsetHeight+"px"),r.style.top=t._getOffsetTop(e)+"px",t.$editInput.removeClass("jqx-hidden"),r.value=e.label,t._editedItem=e,setTimeout(function(){r.focus()},0)}}},{key:"_styleChangedHandler",value:function(e){e.detail.styleProperties&&e.detail.styleProperties["font-size"]&&this._checkOverflow()}},{key:"_updateScrollButtonVisibility",value:function(){var e=this,t=e.overflow;if("scrollbar"!==e.scrollMode&&"hidden"!==t){var r=!0,n=!0;if(0===Math.round(e.$.scrollViewer.scrollTop)&&(r=!1),Math.round(e.$.scrollViewer.$.scrollViewerContainer.offsetHeight+e.$.scrollViewer.scrollTop)>=Math.round(e.$.scrollViewer.$.scrollViewerContentContainer.offsetHeight)&&(n=!1),"auto"===t){if(r&&n)return e.$scrollButtonNear.removeClass("jqx-hidden"),e.$scrollButtonFar.removeClass("jqx-hidden"),e.$scrollViewer.removeClass("one-button-shown"),void e.$.scrollViewer.refresh();r?e.$scrollButtonNear.removeClass("jqx-hidden"):e.$scrollButtonNear.addClass("jqx-hidden"),n?e.$scrollButtonFar.removeClass("jqx-hidden"):e.$scrollButtonFar.addClass("jqx-hidden"),e.$scrollViewer.addClass("one-button-shown"),e.$.scrollViewer.refresh()}else"scroll"!==t||e.disabled||(e.$.scrollButtonNear.disabled=!r,e.$.scrollButtonFar.disabled=!n)}}},{key:"_updateState",value:function(e,t,r){var n=this;switch(e){case"expanded":var a=n._state.expanded.indexOf(t);if(r&&-1===a)n._state.expanded.push(t);else{if(r||-1===a)return;n._state.expanded.splice(a,1)}break;case"filter":n._state.filter=void 0!==t?t:n.$.filterInput.value;break;case"selected":n._state.selected=[];for(var l=0;l<n.selectedIndexes.length;l++){var o=n._menuItems[n.selectedIndexes[l]];n._state.selected.push(o.id)}break;case"sorted":n._state.sorted=t}n.autoSaveState&&window.localStorage.setItem("jqxTree"+n.id,JSON.stringify(n._state))}},{key:"_verticalScrollbarHandler",value:function(){var e=this,t=e.$.verticalScrollBar,r=t.value;if(!e.disabled){if(t.max===r)return void(e._bottomReached||(e.$.fireEvent("scrollBottomReached"),delete e._topReached,e._bottomReached=!0));if(t.min===r)return void(e._topReached||(e.$.fireEvent("scrollTopReached"),delete e._bottomReached,e._topReached=!0));delete e._topReached,delete e._bottomReached}}}],[{key:"properties",get:function(){return{allowDrag:{value:!1,type:"boolean"},allowDrop:{value:!1,type:"boolean"},autoHideToggleElement:{value:!1,type:"boolean"},autoLoadState:{value:!1,type:"boolean"},autoSaveState:{value:!1,type:"boolean"},autoSort:{value:!0,type:"boolean"},displayLoadingIndicator:{value:!1,type:"boolean"},dragFeedbackFormatFunction:{value:null,type:"function?"},dragOffset:{value:[10,10],type:"array"},editable:{value:!1,type:"boolean"},filterable:{value:!1,type:"boolean"},filterInputPlaceholder:{value:"",type:"string"},filterMode:{value:"containsIgnoreCase",allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase"],type:"string"},hasThreeStates:{value:!1,type:"boolean"},loadingIndicatorPlaceholder:{value:"Loading...",type:"string"},loadingIndicatorPosition:{value:"center",allowedValues:["bottom","center","top"],type:"string"},messages:{value:{en:{noId:"jqx-tree: Saving and loading the element's state are not available if the element has no id."}},type:"object",extend:!0},scrollMode:{value:"scrollbar",allowedValues:["scrollbar","scrollButtons"],type:"string"},selectedIndexes:{value:[],type:"array"},selectionDisplayMode:{value:"row",allowedValues:["row","label"],type:"string"},selectionMode:{value:"one",allowedValues:["none","oneOrManyExtended","zeroOrMany","oneOrMany","zeroOrOne","one","checkBox","radioButton"],type:"string"},showLines:{value:!1,type:"boolean"},showRootLines:{value:!1,type:"boolean"},sort:{value:null,type:"function?"},sortDirection:{value:"asc",allowedValues:["asc","desc"],type:"string"},sorted:{value:!1,type:"boolean"},toggleElementPosition:{value:"near",allowedValues:["near","far"],type:"string"},toggleMode:{value:"dblclick",allowedValues:["click","dblclick","arrow"],type:"string"}}}},{key:"listeners",get:function(){return{blur:"_blurHandler",focus:"_focusHandler",keydown:"_keydownHandler",mouseenter:"_mouseenterHandler",mouseleave:"_mouseleaveHandler",resize:"_checkOverflow",styleChanged:"_styleChangedHandler",transitionend:"_overriddenMenuHandler","container.click":"_overriddenMenuHandler","container.mouseout":"_overriddenMenuHandler","container.mouseover":"_overriddenMenuHandler","editInput.blur":"_editInputBlurHandler","filterInput.keydown":"_filterInputKeydownHandler","filterInput.keyup":"_filterInputKeyupHandler","mainContainer.click":"_overriddenMenuHandler","mainContainer.mouseleave":"_overriddenMenuHandler","mainContainer.mouseout":"_overriddenMenuHandler","mainContainer.mouseover":"_overriddenMenuHandler","mainContainer.swipeleft":"_mainContainerSwipeHandler","mainContainer.swiperight":"_mainContainerSwipeHandler","scrollButtonFar.click":"_scrollButtonFarClickHandler","scrollButtonNear.click":"_scrollButtonNearClickHandler","scrollViewer.down":"_scrollViewerDownHandler","scrollViewer.kineticScroll":"_scrollViewerWheelHandler","mainContainer.wheel":"_scrollViewerWheelHandler","document.move":"_moveHandler","document.up":"_documentUpHandler"}}},{key:"requires",get:function(){return{"JQX.ScrollBar":"jqxscrollbar.js"}}},{key:"styleUrls",get:function(){return["jqx.scrollbar.css","jqx.scrollviewer.css","jqx.tree.css"]}}]),t}(JQX.Menu));
//# sourceMappingURL=jqxtree.js.map
