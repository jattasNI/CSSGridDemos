"use strict";JQX.Utilities.Assign("FilterGroup",function(){function e(){babelHelpers.classCallCheck(this,e);var t=this;t.stringConditions=["EMPTY","NOT_EMPTY","CONTAINS","CONTAINS_CASE_SENSITIVE","DOES_NOT_CONTAIN","DOES_NOT_CONTAIN_CASE_SENSITIVE","STARTS_WITH","STARTS_WITH_CASE_SENSITIVE","ENDS_WITH","ENDS_WITH_CASE_SENSITIVE","EQUAL","EQUAL_CASE_SENSITIVE","NULL","NOT_NULL"],t.numericConditions=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"],t.dateConditions=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"],t.booleanConditions=["EQUAL","NOT_EQUAL","NULL","NOT_NULL"],t.filters=new Array,t.logicalOperators=new Array}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){for(var t=this,r=!0,n=0;n<t.filters.length;n++){var i=t.filters[n].evaluate(e);r=0===n?i:1===t.logicalOperators[n]||"or"===t.logicalOperators[n]?r||i:r&&i}return r}},{key:"getFiltersCount",value:function(){return this.filters.length}},{key:"setConditions",value:function(e,t){var r=this;switch(e){case"numeric":r.numericConditions=t;break;case"string":r.stringConditions=t;break;case"date":case"time":r.dateConditions=t;break;case"bool":case"boolean":r.booleanConditions=t}}},{key:"getConditions",value:function(e){var t=this,r=new Array;switch(e){case"numeric":r=t.numericConditions.slice(0);break;case"string":r=t.stringConditions.slice(0);break;case"date":case"time":r=t.dateConditions.slice(0);break;case"bool":case"boolean":r=t.booleanConditions.slice(0)}return r}},{key:"generateFilterKey",value:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+"-"+e()+"-"+e()}},{key:"createFilter",value:function(e,t,r,n,i,a,l){if(null===e||void 0===e)return null;switch(e){case"int":case"float":case"int64":case"double":case"numeric":case"number":case"numericFilter":return new JQX.Utilities.NumericFilter(t,r.toUpperCase());case"string":case"stringFilter":return new JQX.Utilities.StringFilter(t,r.toUpperCase(),a);case"date":case"time":case"dateFilter":return new JQX.Utilities.DateFilter(t,r.toUpperCase(),i,a,l);case"bool":case"boolean":case"booleanFilter":return new JQX.Utilities.BooleanFilter(t,r.toUpperCase());case"custom":return new JQX.Utilities.CustomFilter(t,r.toUpperCase(),n)}throw new Error('jqxGrid: There is no such filter type. The available filter types are: "numericFilter", "stringFilter", "dateFilter" and "booleanFilter"')}},{key:"getFilters",value:function(){for(var t=this,r=new Array,n=0;n<t.filters.length;n++){var i=t.filters[n];if(i instanceof e){var a=i.getFilters();r.push({value:a,logicalOperator:t.logicalOperators[n],type:"FilterGroup"})}else{var l={value:i.value,condition:i.condition,logicalOperator:t.logicalOperators[n],type:i.type};i.data&&(l.id=i.data),r.push(l)}}return r}},{key:"addFilter",value:function(e,t){var r=this;r.filters[r.filters.length]=t,t.key=r.generateFilterKey(),r.logicalOperators[r.logicalOperators.length]=e}},{key:"removeFilter",value:function(e){for(var t=this,r=0;r<t.filters.length;r++)if(t.filters[r].key===e.key){t.filters.splice(r,1),t.logicalOperators.splice(r,1);break}}},{key:"getOperatorAt",value:function(e){var t=this;return void 0===e||null===e?null:e<0||e>t.filters.length?null:t.logicalOperators[e]}},{key:"setOperatorAt",value:function(e,t){var r=this;return void 0===e||null===e?null:e<0||e>r.filters.length?null:void(r.logicalOperators[t]=t)}},{key:"getFilterAt",value:function(e){var t=this;return void 0===e||null===e?null:e<0||e>t.filters.length?null:t.filters[e]}},{key:"setFilterAt",value:function(e,t){var r=this;return void 0===e||null===e?null:e<0||e>r.filters.length?null:(t.key=r.generateFilterKey(),void(r.filters[e]=t))}},{key:"clear",value:function(){var e=this;e.filters=new Array,e.logicalOperators=new Array}},{key:"getUniqueValues",value:function(e,t){for(var r=e.data,n=[],i=[],a="dateFilter"===e.filterType&&"timePicker"===e.displayMode,l=void 0,s=!1,o=0;o<r.length;o++){var u=r[o][e.dataField];if(""!==u&&null!==u&&void 0!==u){var c=void 0;c=a?new JQX.Utilities.DateTime(u).toString(e.formatString):u.toString(),-1===n.indexOf(c)&&(n.push(c),i.push({label:c,value:u,customAttribute:"default-item"}))}else s=!0}switch(e.filterType){case"numericFilter":case"booleanFilter":l=function(e,t){return e.value-t.value};break;case"stringFilter":l=function(e,t){return(new Intl.Collator).compare(e.value,t.value)};break;case"dateFilter":l=a?function(e,t){try{var r=e.value.getHours(),n=t.value.getHours();if(r!==n)return r-n;var i=e.value.getMinutes(),a=t.value.getMinutes();if(i!==a)return i-a;var l=e.value.getSeconds(),s=t.value.getSeconds();return l!==s?l-s:0}catch(e){return-1}}:function(e,t){try{return e.value.getTime()-t.value.getTime()}catch(e){return-1}}}return i.sort(l),"booleanFilter"===e.filterType&&i.map(function(e){e.label=e.label.toUpperCase()}),s&&i.push({label:t.localize("blanks"),value:"",customAttribute:"default-item"}),i}}]),e}()),JQX.Utilities.Assign("StringFilter",function(){function e(t,r,n){babelHelpers.classCallCheck(this,e);var i=this;i.value=t,i.condition=r,i.locale=n||"en",i.type="stringFilter"}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){var t=this,r=t.value,n=t.condition;if(null===e||void 0===e||""===e){if("NULL"===n)return!0;if("EQUAL"===n&&e===r)return!0;if("NOT_EQUAL"===n&&e!==r)return!0;if("EMPTY"!==n)return!1;if(""===e)return!0}var i="";try{i=e.toString()}catch(e){return!0}var a=function(e,r){var i=t.locale;switch(n){case"EQUAL":return 0===e.localeCompare(r,i,{sensitivity:"accent"});case"EQUAL_CASE_SENSITIVE":return 0===e.localeCompare(r,i,{sensitivity:"variant"});case"NOT_EQUAL":return 0!==e.localeCompare(r,i,{sensitivity:"accent"});case"NOT_EQUAL_CASE_SENSITIVE":return 0!==e.localeCompare(r,i,{sensitivity:"variant"});case"CONTAINS":return-1!==e.toLowerCase().indexOf(r.toLowerCase());case"CONTAINS_CASE_SENSITIVE":return-1!==e.indexOf(r);case"DOES_NOT_CONTAIN":return-1===e.toLowerCase().indexOf(r.toLowerCase());case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return-1===e.indexOf(r);case"EMPTY":return""===e;case"NOT_EMPTY":return""!==e;case"NOT_NULL":return null!==e;case"STARTS_WITH":return e=e.substring(0,r.length),0===e.localeCompare(r,i,{sensitivity:"accent"});case"ENDS_WITH":return e=e.substring(e.length-r.length,e.length),0===e.localeCompare(r,i,{sensitivity:"accent"});case"ENDS_WITH_CASE_SENSITIVE":return e=e.substring(e.length-r.length,e.length),0===e.localeCompare(r,i,{sensitivity:"variant"});case"STARTS_WITH_CASE_SENSITIVE":return e=e.substring(0,r.length),0===e.localeCompare(r,i,{sensitivity:"variant"});default:return!1}},l=new Array;if(r&&r.indexOf&&(r.indexOf("|")>=0||r.indexOf(" AND ")>=0||r.indexOf(" OR ")>=0||r.indexOf(" and ")>=0||r.indexOf(" or ")>=0)){var s=a(i,r);if(s)return s;var o=r.indexOf(" and ")>=0?r.split(" and "):new Array,u=r.indexOf(" or ")>=0?r.split(" or "):new Array,c=r.indexOf("|")>=0?r.split("|"):new Array,f=r.indexOf(" AND ")>=0?r.split(" AND "):new Array,g=r.indexOf(" OR ")>=0?r.split(" OR "):new Array;if(c.length>0)for(var d=0;d<c.length;d++)c[d]=c[d].trim;var S=r.indexOf(" ")>=0?r.split(" "):new Array;if(S.length>0)for(var v=0;v<S.length;v++)S[v]=S[v].trim;if(f=f.concat(S),f=f.concat(o),g=g.concat(c),g=g.concat(u),f.length>0)for(var O=0;O<f.length;O++)!f[O].indexOf(" OR ")>=0&&l.push(f[O]);if(g.length>0)for(var N=0;N<g.length;N++)!g[N].indexOf(" AND ")>=0&&l.push(g[N]);for(var A=void 0,T=0;T<l.length;T++){var E=l[T],h=a(i,E),_=T<f.length?"and":"or";A=void 0===A?h:"or"===_?A||h:A&&h}return A}return a(i,r)}}]),e}()),JQX.Utilities.Assign("BooleanFilter",function(){function e(t,r){babelHelpers.classCallCheck(this,e);var n=this;n.value=t,n.condition=r,n.type="booleanFilter"}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){var t=this,r=t.value,n=t.condition,i=e;switch(n){case"EQUAL":return i===r;case"NOT_EQUAL":return i!==r;case"NULL":return null===e||void 0===e||""===e;case"NOT_NULL":return!(null===e||void 0===e||""===e);default:return!1}}}]),e}()),JQX.Utilities.Assign("NumericFilter",function(){function e(t,r){babelHelpers.classCallCheck(this,e);var n=this;n.value=t,n.condition=r,n.type="numericFilter"}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){var t=this,r=t.value,n=t.condition;if(null===e||void 0===e||""===e){if("NOT_NULL"===n)return!1;if("NULL"===n)return!0;switch(n){case"EQUAL":return e===r;case"NOT_EQUAL":return e!==r}return!1}if("NULL"===n)return!1;if("NOT_NULL"===n)return!0;var i=e;try{i=parseFloat(i)}catch(t){if(""!==e.toString())return!1}var a=function(e,t){switch("number"==typeof e&&"number"!=typeof t&&(t=parseFloat(t)),n){case"EQUAL":return e===t;case"NOT_EQUAL":return e!==t;case"GREATER_THAN":return e>t;case"GREATER_THAN_OR_EQUAL":return e>=t;case"LESS_THAN":return e<t;case"LESS_THAN_OR_EQUAL":return e<=t;case"STARTS_WITH":return t=t.toString().toLowerCase(),e.toString().toLowerCase().substring(0,t.length)===t;case"ENDS_WITH":return e=e.toString().toLowerCase(),t=t.toString().toLowerCase(),e.substring(e.length-t.length,e.length)===t;case"ENDS_WITH_CASE_SENSITIVE":return e=e.toString(),t=t.toString(),e.substring(e.length-t.length,e.length)===t;case"STARTS_WITH_CASE_SENSITIVE":return t=t.toString(),e.toString().substring(0,t.length)===t;case"CONTAINS":return-1!==e.toString().toLowerCase().indexOf(t.toString().toLowerCase());case"CONTAINS_CASE_SENSITIVE":return-1!==e.toString().indexOf(t.toString());case"DOES_NOT_CONTAIN":return-1===e.toString().toLowerCase().indexOf(t.toString().toLowerCase());case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return-1===e.toString().indexOf(t.toString());default:return!0}},l=new Array;if(r&&r.indexOf&&(r.indexOf("|")>=0||r.indexOf(" AND ")>=0||r.indexOf(" OR ")>=0||r.indexOf(" and ")>=0||r.indexOf(" or ")>=0)){var s=a(i,r);if(s)return s;r=r.toString();var o=r.indexOf(" and ")>=0?r.split(" and "):new Array,u=r.indexOf(" or ")>=0?r.split(" or "):new Array,c=r.indexOf("|")>=0?r.split("|"):new Array,f=r.indexOf(" AND ")>=0?r.split(" AND "):new Array,g=r.indexOf(" OR ")>=0?r.split(" OR "):new Array;if(f=f.concat(o),g=g.concat(u),c.length>0)for(var d=0;d<c.length;d++)c[d]=c[d].trim;if(g=g.concat(c),f.length>0)for(var S=0;S<f.length;S++)!f[S].indexOf(" OR ")>=0&&l.push(f[S]);if(g.length>0)for(var v=0;v<g.length;v++)!g[v].indexOf(" AND ")>=0&&l.push(g[v]);for(var O=void 0,N=0;N<l.length;N++){var A=l[N];if(A&&A.indexOf&&A.indexOf("..")>=0){var T=A.toString().split("..");2===T.length&&(s=i>=T[0]&&i<=T[1])}else s=a(i,A);var E=N<f.length?"and":"or";O=void 0===O?s:"or"===E?O||s:O&&s}return O}return r&&r.indexOf&&r.indexOf("..")>=0&&(l=r.toString().split(".."),2===l.length)?i>=l[0]&&i<=l[1]:a(i,r)}}]),e}()),JQX.Utilities.Assign("DateFilter",function(){function e(t,r,n,i,a){babelHelpers.classCallCheck(this,e);var l=this,s=new JQX.Utilities.DateTime;if(l.value=t,l.type="dateFilter",void 0!==n){var o=s.parseDate(t,n);if(null!==o)l.filterdate=o;else{var u=s.tryparseDate(t);null!==u&&(l.filterdate=u)}}else{var c=new Date(t);"NaN"===c.toString()||"Invalid Date"===c.toString()?l.filterdate=s.tryparseDate(t):l.filterdate=c}if(!l.filterdate){var f=new Date(t);"NaN"===f.toString()||"Invalid Date"===f.toString()?l.filterdate=s.tryparseDate(t):l.filterdate=f}l.condition=r,l.formatString=n,l.timeOnly=a}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){var t=this,r=t.condition,n=t.formatString,i=t.value;if(t.timeOnly)return t.evaluateTimeOnly(e);if(null===e||void 0===e||""===e){if("NOT_NULL"===r)return!1;if("NULL"===r)return!0;switch(r){case"EQUAL":return e===i;case"NOT_EQUAL":return e!==i}return!1}if("NULL"===r)return!1;if("NOT_NULL"===r)return!0;var a=new Date,l=void 0;a.setFullYear(1900,0,1),a.setHours(12,0,0,0);try{var s=new JQX.Utilities.DateTime,o=new Date(e);if(e="NaN"===o.toString()||"Invalid Date"===o.toString()?s.tryparseDate(e):o,a=e,l=!1,void 0!==n&&(n.indexOf("t")>=0||n.indexOf("T")>=0||n.indexOf(":")>=0||n.indexOf("f")>=0)&&(l=!0,i&&-1===i.toString().indexOf(":"))){var u=s.tryparseDate(i.toString()+":00");null!==u&&(t.filterdate=u)}l||(a.setHours(0),a.setMinutes(0),a.setSeconds(0))}catch(t){if(""!==e.toString())return!1}if(null!==t.filterdate)i=t.filterdate;else if(i&&i.indexOf&&(-1!==i.indexOf(":")||!isNaN(parseInt(i)))){var c=new Date(a);c.setHours(12,0,0,0);for(var f=i.split(":"),g=0;g<f.length;g++)0===g&&c.setHours(f[g]),1===g&&c.setMinutes(f[g]),2===g&&c.setSeconds(f[g]);i=c}l&&i&&i.setFullYear&&a&&a.getFullYear&&-1===n.indexOf("d")&&-1===n.indexOf("M")&&-1===n.indexOf("y")&&i.setFullYear(a.getFullYear(),a.getMonth(),a.getDate());var d=function(e,t){switch(null===e&&(e=""),r){case"EQUAL":return e.toString()===t.toString();case"NOT_EQUAL":return e.toString()!==t.toString();case"GREATER_THAN":return e>t;case"GREATER_THAN_OR_EQUAL":return e>=t;case"LESS_THAN":return e<t;case"LESS_THAN_OR_EQUAL":return e<=t;case"STARTS_WITH":return t=t.toString().toLowerCase(),e.toString().toLowerCase().substring(0,t.length)===t;case"ENDS_WITH":return e=e.toString().toLowerCase(),t=t.toString().toLowerCase(),e.substring(e.length-t.length,e.length)===t;case"ENDS_WITH_CASE_SENSITIVE":return e=e.toString(),t=t.toString(),e.substring(e.length-t.length,e.length)===t;case"STARTS_WITH_CASE_SENSITIVE":return t=t.toString(),e.toString().substring(0,t.length)===t;case"CONTAINS":return-1!==e.toString().toLowerCase().indexOf(t.toString().toLowerCase());case"CONTAINS_CASE_SENSITIVE":return-1!==e.toString().indexOf(t.toString());case"DOES_NOT_CONTAIN":return-1===e.toString().toLowerCase().indexOf(t.toString().toLowerCase());case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return-1===e.toString().indexOf(t.toString());default:return!0}},S=new Array;if(i&&i.indexOf&&(i.indexOf("|")>=0||i.indexOf(" AND ")>=0||i.indexOf(" OR ")>=0||i.indexOf(" and ")>=0||i.indexOf(" or ")>=0)){var v=d(a,i);if(v)return v;var O=i.indexOf(" and ")>=0?i.split(" and "):new Array,N=i.indexOf(" or ")>=0?i.split(" or "):new Array,A=i.indexOf("|")>=0?i.split("|"):new Array,T=i.indexOf(" AND ")>=0?i.split(" AND "):new Array,E=i.indexOf(" OR ")>=0?i.split(" OR "):new Array;if(T=T.concat(O),E=E.concat(N),A.length>0)for(var h=0;h<A.length;h++)A[h]=A[h].trim;if(E=E.concat(A),T.length>0)for(var _=0;_<T.length;_++)!T[_].indexOf(" OR ")>=0&&S.push(T[_]);if(E.length>0)for(var p=0;p<E.length;p++)!E[p].indexOf(" AND ")>=0&&S.push(E[p]);for(var C=void 0,L=0;L<S.length;L++){var y=S[L];if(y&&y.indexOf&&y.indexOf("..")>=0){var U=y.toString().split("..");2===U.length&&(v=a>=U[0]&&a<=U[1])}else v=d(a,y);var I=L<T.length?"and":"or";C=void 0===C?v:"or"===I?C||v:C&&v}return C}return i&&i.indexOf&&i.indexOf("..")>=0&&(S=i.toString().split(".."),2===S.length)?a>=S[0]&&a<=S[1]:d(a,i)}},{key:"evaluateTimeOnly",value:function(e){var t=this,r=t.value;return r?!!(e&&e instanceof Date)&&(e.getHours()===r.getHours()&&(e.getMinutes()===r.getMinutes()&&e.getSeconds()===r.getSeconds())):!e}}]),e}()),JQX.Utilities.Assign("CustomFilter",function(){function e(t,r,n){babelHelpers.classCallCheck(this,e);var i=this;i.value=t,i.condition=r,i.customfilter=n}return babelHelpers.createClass(e,[{key:"evaluate",value:function(e){var t=this;return t.customfilter(t.value,e,t.condition)}}]),e}()),JQX.FilterGroup=JQX.Utilities.FilterGroup,JQX.StringFilter=JQX.Utilities.StringFilter,JQX.NumericFilter=JQX.Utilities.NumericFilter,JQX.DateFilter=JQX.Utilities.DateFilter,JQX.CustomFilter=JQX.Utilities.CustomFilter;
//# sourceMappingURL=jqxfilter.js.map
