"use strict";JQX.Utilities.Assign("Grid.Export",function(){function o(){babelHelpers.classCallCheck(this,o)}return babelHelpers.createClass(o,[{key:"exportData",value:function(o){var r=this,e=new JQX.Utilities.DataExporter({exportHeader:r.dataExport.header});if(e.expandChar=r.dataExport.expandChar,e.collapseChar=r.dataExport.collapseChar,e.pageOrientation=r.dataExport.pageOrientation,e.style=r.dataExport.style,e.filterBy=r.dataExport.filterBy,e.groupBy=r.dataExport.groupBy,e.header={columns:r.columns.toArray().slice(0),columngroups:r.columnGroups.slice(0)},!r.dataExport.style){var a=window.getComputedStyle(r),t=window.getComputedStyle(r.columns.length>0&&r.columns[0].element?r.columns[0].element:r.$.columnHeader),l=window.getComputedStyle(r.$.columnHeader);if(!(0===r.offsetWidth||0===r.offsetHeight)){for(var n=function(o){function r(o){return o=o.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),o?"#"+e(o[1])+e(o[2])+e(o[3]).toUpperCase():"#ffffff"}function e(o){return isNaN(o)?"00":i[(o-o%16)/16]+i[o%16]}var a=o.fontSize,t=o.borderRightColor,l=o.backgroundColor,n=o.color,i=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");return{borderColor:r(t),fontSize:a,fontFamily:"Helvetica",color:r(n),backgroundColor:r(l)}},i=n(a),d=n(t),c=n(l),p={height:r.$.columnHeader.offsetHeight+"px",border:"1px solid "+i.borderColor,fontFamily:c.fontFamily,fontSize:c.fontSize,color:c.color,backgroundColor:d.backgroundColor,fontWeight:"400"},u={border:"1px solid "+i.borderColor,fontFamily:i.fontFamily,fontSize:i.fontSize,color:i.color,backgroundColor:i.backgroundColor},s={height:r.rowMinHeight+"px"},f=0;f<r.columns.length;f++){var g=r.columns[f];if(g.allowExport&&g.visible){p[g.dataField]={textAlign:g.align,width:g.computedWidth+"px",format:g.cellsFormat||""};var h=g.cellsFormat||"";"date"===g.dataType?h="d":"dateTime"===g.dataType?h="D":"time"===g.dataType&&(h="t"),u[g.dataField]={textAlign:g.cellsAlign,format:h}}}r.appearance.alternationCount>0&&(s.alternationCount=r.appearance.alternationCount,s.alternationStart=r.appearance.alternationStart,s.alternationEnd=r.appearance.alternationEnd,s.alternationIndex0Color=i.backgroundColor,s.alternationIndex0BackgroundColor=i.color,s.alternationIndex1Color="#aaa",s.alternationIndex1BackgroundColor="#333"),e.style={border:"1px solid "+i.borderColor,borderCollapse:"collapse",header:p,columns:u,rows:s}}}for(var m=!r.rowHierarchy||r.grouping.enabled?r.rows.toArray():r.rowHierarchy,y=[],C=0;C<m.length;C++){var x=m[C];!x.visible||!1===x.filtered&&void 0!==x.filtered||y.push(x.data)}m===r.rowHierarchy&&(y=r.dataSource.boundHierarchy,e.hierarchical=!0),!r.dataExport.groupBy&&r.grouping.enabled&&r.dataSource&&r.dataSource.groupBy&&(e.groupBy=r.dataSource.groupBy.toArray()),r.checkLicense(!0),e.exportData(y,o,r.dataExport.fileName)}}]),o}());
//# sourceMappingURL=jqxgrid.export.js.map
